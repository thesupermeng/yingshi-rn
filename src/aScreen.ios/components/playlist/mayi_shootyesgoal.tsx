import React, { useEffect, useState, useCallback, useMemo, memo } from 'react';
import { useNavigation, useTheme } from '@react-navigation/native';
import { mayi_Runtime, mayi_EmptyGradle } from '@type/mayi_green';
import { playVod, viewPlaylistDetails } from '@redux/actions/mayi_goallogo';
import { View, StyleSheet, Text, TouchableOpacity, FlatList, Linking } from 'react-native';
import RightIcon from '@static/images/scorepopsoundDefaultprofilepicDycreator.svg';
import VodCard from '../vod/mayi_pressure_footballfiledlayout';
import { useAppDispatch } from '@hooks/mayi_redirect';
import { TextStyle } from 'react-native';
import appsFlyer from 'react-native-appsflyer';
import mayi_push from '../../../../Umeng/mayi_push';

interface mayi_GoogleViews {
  playlist: mayi_Runtime;
  titleStyle?: TextStyle;
}

type mayi_EventLibnms = {
  item: mayi_EmptyGradle;
  index: number;
};

function VodPlaylist({ playlist, titleStyle }: mayi_GoogleViews) {
  const { textVariants, spacing, colors, icons } = useTheme();
  const navigator = useNavigation();
  const dispatch = useAppDispatch();

  const viewMore = () => {
       let typingX = 0;
    let darkj = String.fromCharCode(120,95,55,95,116,105,109,115,116,97,109,112,0);
    let xvodz = 1.0;
    let subsz = 0;
    let gestureG = 0;
    let animationsT = 2.0;
    let iconwechat7 = true;
    let stepU = String.fromCharCode(105,95,55,52,95,99,97,112,116,105,111,110,115,0);
    let stepF = String.fromCharCode(105,110,116,101,102,97,99,101,95,105,95,50,57,0);
    let rewindv = String.fromCharCode(99,95,52,50,95,109,97,112,112,101,100,0);
    let filledI: Map<any, any> = new Map([[String.fromCharCode(107,95,49,54,95,118,97,114,119,105,100,116,104,0),false ], [String.fromCharCode(115,95,53,49,95,115,115,101,100,105,102,102,0),true ], [String.fromCharCode(104,95,51,54,95,115,117,98,98,108,111,99,107,115,0),false ]]);
    let spinnerh: Array<any> = [629, 216, 168];
    let calendarg: Map<any, any> = new Map([[String.fromCharCode(101,95,57,56,95,109,121,113,114,0),349], [String.fromCharCode(99,114,117,110,95,97,95,56,52,0),969], [String.fromCharCode(120,95,56,54,95,102,97,99,105,108,105,116,97,116,101,0),798]]);
    let appleq = 0.0;
    let rewardk = true;
    let auto_pN = String.fromCharCode(102,105,110,116,95,50,95,52,54,0);
    let reducerU = String.fromCharCode(102,105,108,108,105,110,103,95,56,95,55,0);
       let flipperp: Map<any, any> = new Map([[String.fromCharCode(118,95,54,48,95,111,108,100,101,115,116,0),true ], [String.fromCharCode(116,95,53,52,95,117,110,109,105,110,105,109,105,122,101,0),true ], [String.fromCharCode(120,95,50,57,95,99,111,110,99,114,101,116,101,0),false ]]);
       let windo = String.fromCharCode(99,117,114,108,121,95,120,95,55,56,0);
         flipperp.set(windo, windo.length);
         windo = `${windo.length}`;
      rewindv += `${stepU.length | parseInt(`${xvodz}`)}`;
       let hometeamfield_ = 5.0;
       let tempnodatagifN: Map<any, any> = new Map([[String.fromCharCode(108,111,103,111,117,114,108,95,49,95,51,57,0),false ], [String.fromCharCode(116,114,105,112,108,101,116,95,115,95,49,54,0),false ]]);
         tempnodatagifN = new Map([[`${tempnodatagifN.size}`, 1 >> (Math.min(2, Math.abs(tempnodatagifN.size)))]]);
       let schedulery: Map<any, any> = new Map([[String.fromCharCode(97,114,114,97,121,95,55,95,50,54,0),793], [String.fromCharCode(115,116,114,105,115,116,97,114,116,95,97,95,53,54,0),74], [String.fromCharCode(117,95,49,53,95,116,114,101,101,119,114,105,116,101,114,0),12]]);
       let iconqqZ: Map<any, any> = new Map([[String.fromCharCode(100,101,116,101,99,116,105,110,103,0),967], [String.fromCharCode(110,101,120,116,95,111,95,55,0),579], [String.fromCharCode(98,110,99,98,98,95,100,95,50,56,0),846]]);
         schedulery = new Map([[`${schedulery.size}`, tempnodatagifN.size]]);
      while (5 == (schedulery.size | 4)) {
         schedulery.set(`${schedulery.size}`, iconqqZ.size);
         break;
      }
      for (let t = 0; t < 2; t++) {
         hometeamfield_ += parseFloat(`${parseInt(`${hometeamfield_}`)}`);
      }
         tempnodatagifN.set(`${tempnodatagifN.size}`, tempnodatagifN.size);
      filledI.set(`${hometeamfield_}`, 1 << (Math.min(Math.abs(parseInt(`${hometeamfield_}`)), 3)));
      spinnerh.push(rewindv.length);
   if (2 < (spinnerh.length ^ 4) || 4 < (4 ^ spinnerh.length)) {
      stepF = `${3 + filledI.size}`;
   }

    dispatch(viewPlaylistDetails(playlist));
    navigator.navigate('PlaylistDetail', { topic_id: playlist.topic_id });

    

      rewindv = "1";
   if (5 > (darkj.length ^ typingX)) {
      darkj = `${gestureG}`;
   }
       let friendsM = String.fromCharCode(119,95,49,53,95,115,116,117,102,102,105,110,103,0);
       let iconclosewhite2 = String.fromCharCode(102,95,55,51,95,110,111,116,97,116,105,111,110,0);
          let xvodc = String.fromCharCode(115,101,110,116,95,111,95,54,54,0);
         friendsM += `${iconclosewhite2.length}`;
         xvodc = `${3 ^ xvodc.length}`;
      if (!iconclosewhite2.includes(`${friendsM.length}`)) {
          let weatherx: Array<any> = [String.fromCharCode(108,97,116,101,114,95,107,95,50,53,0), String.fromCharCode(103,95,49,55,95,115,101,116,116,105,110,103,115,0), String.fromCharCode(112,95,48,95,117,116,103,111,105,110,103,0)];
          let iconstarR: Map<any, any> = new Map([[String.fromCharCode(99,105,110,101,95,52,95,52,50,0),false ], [String.fromCharCode(105,116,101,114,97,116,111,114,95,108,95,54,57,0),false ], [String.fromCharCode(117,95,54,54,95,109,97,116,99,104,105,110,103,0),true ]]);
          let resend_ = 5.0;
          let frame_n2 = 0;
          let imagemanagerZ = false;
         friendsM = `${(String.fromCharCode(102,0) == friendsM ? friendsM.length : frame_n2)}`;
         weatherx.push(3 * parseInt(`${resend_}`));
         iconstarR = new Map([[`${iconstarR.size}`, 1]]);
         resend_ += 3 << (Math.min(5, Math.abs(iconstarR.size)));
         frame_n2 &= parseInt(`${resend_}`) & 3;
         imagemanagerZ = (63 > ((imagemanagerZ ? 63 : weatherx.length) & weatherx.length));
      }
          let chinasamed = String.fromCharCode(110,101,103,95,117,95,53,49,0);
          let gradle1 = true;
         friendsM = `${((gradle1 ? 2 : 4))}`;
         chinasamed = `${chinasamed.length}`;
         gradle1 = chinasamed == chinasamed;
      while (friendsM.length > 2) {
         iconclosewhite2 += `${(friendsM == String.fromCharCode(67,0) ? friendsM.length : iconclosewhite2.length)}`;
         break;
      }
         friendsM = "3";
      while (friendsM.endsWith(iconclosewhite2)) {
          let invitei: Map<any, any> = new Map([[String.fromCharCode(105,110,105,116,118,95,49,95,57,56,0),467], [String.fromCharCode(108,105,98,116,103,118,111,105,112,95,118,95,55,50,0),7]]);
          let predictionarrow_ = String.fromCharCode(119,114,105,116,101,116,114,117,110,99,95,104,95,50,49,0);
          let iconwatchnows = true;
         friendsM = "1";
         invitei.set(predictionarrow_, ((iconwatchnows ? 4 : 3) ^ predictionarrow_.length));
         iconwatchnows = 37 <= predictionarrow_.length && 37 <= invitei.size;
         break;
      }
      filledI = new Map([[stepF, 1]]);
      stepF += `${parseInt(`${animationsT}`)}`;
    mayi_push.playlistClickAnalytics({
      topic_id: playlist.topic_id.toString(),
      topic_name: playlist.topic_name,
    });
    
  };

  useEffect(() => {
    const eventName = 'topic';
    const eventValues = {
      topic_name: playlist.topic_name,
    };

    
    
    
    
    
    
    
    
    
    
  }, []);

  const renderItem = useCallback(({ item, index }: mayi_EventLibnms) => (
    <VodCard
      vod_name={item.vod_name}
      vodImageStyle={{ width: 120, height: 180 }}
      vod_pic={item.vod_pic}
      onPress={() => {
        dispatch(playVod(item));
        navigator.navigate('播放IOS', {
          vod_id: item.vod_id,
        });

        
        mayi_push.playlistClickAnalytics({
          topic_id: playlist.topic_id.toString(),
          topic_name: playlist.topic_name,
        });
        
      }}
      index={index}
    />
  ), []);

  return (
    <View style={{ ...styles.playlist, gap: spacing.m }}>
      <TouchableOpacity activeOpacity={0.85} onPress={viewMore}>
        <View
          style={{
            paddingLeft: spacing.sideOffset,
            paddingRight: spacing.sideOffset,
            gap: spacing.s,
          }}>
          <View style={styles.header}>
            <Text style={{ ...textVariants.bigHeader, ...titleStyle }}>
              {playlist.topic_name}
            </Text>

            <RightIcon
              color={colors.text}
              height={icons.sizes.l}
              width={icons.sizes.l}
            />
          </View>
          <Text
            numberOfLines={3}
            style={{ ...textVariants.small, color: colors.text, flex: 1 }}>
            {playlist.topic_blurb}
          </Text>
        </View>
      </TouchableOpacity>
      <View style={{ paddingLeft: spacing.sideOffset }}>
        <FlatList
          initialNumToRender={3}
          maxToRenderPerBatch={3}
          windowSize={5}
          data={playlist?.vod_list}
          horizontal
          showsHorizontalScrollIndicator={false}
          renderItem={renderItem}
        />
      </View>
    </View>
  );
}

export default memo(VodPlaylist);

const styles = StyleSheet.create({
  playlist: {
    marginBottom: 12,
  },
  header: {
    display: 'flex',
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
  },
});
