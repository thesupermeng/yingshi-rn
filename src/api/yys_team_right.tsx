import { yys_FavoriteCustom } from "@constants";
import { yys_DataMoon } from "@type/yys_libzeus";
import { yys_StringsVignette } from "@utility/yys_ping";
import { APP_NAME_CONST } from "@utility/yys_ajax_switch";
import { Platform } from "react-native";

export class yys_SubsPlus {
    static getList = async ({ productTypeId }: { productTypeId?: string } = {}) => {
        try {
            const result = await yys_StringsVignette.get(yys_FavoriteCustom.productGetList, {
                query: productTypeId !== undefined ? {
                    product_type_id: productTypeId,
                } : undefined
            });

            if (result.success === false) {
                throw result.message;
            }

            return result.data;

        } catch (e: any) {
            console.error(`[Error getList}]: ${e.toString()}`);
            throw e;
        }
    }

    static getNativeList = async () => {
       let ucopy_01A: Array<any> = [196, 387];
    let crownm = 3;
    let direct1 = 4.0;
    let vignetteg = false;
    let orientationo = String.fromCharCode(113,95,52,49,95,115,105,110,113,105,0);
    let dices = 4;
    let buildE = String.fromCharCode(99,98,99,114,95,100,95,51,56,0);
    let animationw = String.fromCharCode(119,95,51,56,95,99,111,114,114,117,112,116,101,100,0);
    let appleS = 4.0;
    let mathw = 2.0;
    let main_bJ = String.fromCharCode(105,95,54,95,97,108,108,114,103,98,0);
   let actiont = 7372748.0 >= direct1;
   do {
       let pressure3: Array<any> = [449, 137, 53];
         pressure3 = [2 & pressure3.length];
      let mimoa = 9528223 >= pressure3.length;
      do {
         pressure3.push(pressure3.length);
         if (mimoa) {
            break;
         }
      } while ((pressure3.length == pressure3.length) && mimoa);
       let handlerB: Array<any> = [595, 304, 540];
      direct1 -= parseFloat(`${parseInt(`${direct1}`) | 3}`);
      if (actiont) {
         break;
      }
   } while ((4 >= crownm) && actiont);
      vignetteg = (crownm << (Math.min(ucopy_01A.length, 2))) == 29;
   let resultQ = 7946363 <= buildE.length;
   do {
      buildE = `${((vignetteg ? 1 : 1))}`;
      if (resultQ) {
         break;
      }
   } while (resultQ && (orientationo.length == buildE.length));

        try {

   for (let k = 0; k < 1; k++) {
       let volumeN = 1.0;
       let placeholderR = String.fromCharCode(101,95,57,0);
          let schedulerm = true;
          let homeY = String.fromCharCode(112,114,101,117,112,108,111,97,100,95,105,95,51,54,0);
         placeholderR += `${3 * parseInt(`${volumeN}`)}`;
         schedulerm = !schedulerm;
         homeY = `${(2 / (Math.max(4, (schedulerm ? 2 : 1))))}`;
      let targetV = String.fromCharCode(101,107,52,108,113,50,50,0) == placeholderR;
      do {
         placeholderR += `${placeholderR.length / (Math.max(3, 7))}`;
         if (targetV) {
            break;
         }
      } while ((!placeholderR.startsWith(`${volumeN}`)) && targetV);
      for (let c = 0; c < 2; c++) {
         volumeN /= Math.max(1, parseFloat(`${2}`));
      }
         volumeN /= Math.max(1, parseFloat(`${1}`));
      if (parseInt(`${volumeN}`) > placeholderR.length) {
         volumeN *= parseFloat(`${parseInt(`${volumeN}`) % (Math.max(placeholderR.length, 4))}`);
      }
         placeholderR = "2";
      crownm >>= Math.min(Math.abs(dices ^ parseInt(`${direct1}`)), 4);
   }
      ucopy_01A = [crownm ^ buildE.length];
   if (animationw.length < 3) {
      buildE += `${(animationw == String.fromCharCode(51,0) ? buildE.length : animationw.length)}`;
   }
            const result = await yys_StringsVignette.get(yys_FavoriteCustom.nativeProductGetList);

   let china4 = direct1 <= 5397508.0;
   do {
      direct1 /= Math.max(5, parseFloat(`${ucopy_01A.length / 3}`));
      if (china4) {
         break;
      }
   } while (china4 && (!animationw.endsWith(`${direct1}`)));
       let rncoret: Array<any> = [993, 113];
       let textp = String.fromCharCode(115,95,56,50,95,111,112,112,111,115,105,116,101,0);
       let mounting0 = String.fromCharCode(114,101,99,105,112,95,110,95,53,0);
       let graphics6 = 5.0;
      while (textp != mounting0) {
         mounting0 = `${rncoret.length & 3}`;
         break;
      }
       let storej = String.fromCharCode(119,95,49,50,95,110,111,104,101,97,100,101,114,0);
       let contextt = String.fromCharCode(106,95,57,51,95,99,111,110,116,105,103,117,111,117,115,0);
      for (let p = 0; p < 1; p++) {
         mounting0 += "2";
      }
      while (1 <= mounting0.length) {
         mounting0 += "3";
         break;
      }
      while (contextt != String.fromCharCode(85,0) || mounting0.length >= 3) {
         contextt += `${(String.fromCharCode(112,0) == textp ? textp.length : contextt.length)}`;
         break;
      }
      for (let k = 0; k < 3; k++) {
          let sigmobW = String.fromCharCode(104,95,55,50,95,109,97,105,110,0);
          let tooltipsb = String.fromCharCode(109,115,101,99,115,95,99,95,57,53,0);
         mounting0 += `${rncoret.length}`;
         sigmobW = `${sigmobW.length + 1}`;
         tooltipsb = `${(String.fromCharCode(117,0) == sigmobW ? sigmobW.length : tooltipsb.length)}`;
      }
      for (let s = 0; s < 3; s++) {
          let commentZ = String.fromCharCode(98,117,105,108,100,115,95,50,95,53,57,0);
         contextt = `${mounting0.length % (Math.max(2, commentZ.length))}`;
      }
      let internetc = String.fromCharCode(102,120,115,105,119,57,108,104,0) == storej;
      do {
         storej += `${1 | textp.length}`;
         if (internetc) {
            break;
         }
      } while (internetc && (4 == contextt.length || 4 == storej.length));
      dices %= Math.max(orientationo.length, 4);
   let zhuboN = vignetteg ? !vignetteg : vignetteg;
   do {
       let launche = String.fromCharCode(101,118,97,108,117,97,116,105,111,110,95,107,95,55,49,0);
       let telegramT: Array<any> = [725, 23];
       let gray1 = 5.0;
       let larged = 3.0;
       let mbsplashy = false;
         telegramT = [parseInt(`${larged}`) + telegramT.length];
      let eactp = gray1 <= 9838966.0;
      do {
         gray1 += telegramT.length | 3;
         if (eactp) {
            break;
         }
      } while ((1.21 >= gray1) && eactp);
         telegramT = [3 - parseInt(`${gray1}`)];
          let libffmpegkitF = String.fromCharCode(100,111,109,97,105,110,95,109,95,53,50,0);
         mbsplashy = gray1 >= larged;
         libffmpegkitF = "1";
         larged -= (parseFloat(`${(mbsplashy ? 2 : 1) / (Math.max(4, parseInt(`${larged}`)))}`));
       let inviten: Array<any> = [21, 827, 605];
         inviten = [telegramT.length << (Math.min(1, Math.abs(parseInt(`${gray1}`))))];
       let codegenl: Map<any, any> = new Map([[String.fromCharCode(116,95,52,52,95,116,101,114,109,115,0),false ], [String.fromCharCode(108,115,112,100,108,112,99,95,54,95,54,51,0),false ]]);
          let libreanimatedY = String.fromCharCode(111,95,53,50,95,105,110,100,101,111,100,97,116,97,0);
          let minivodm = 0.0;
          let subsk = true;
         inviten.push(codegenl.size * telegramT.length);
         libreanimatedY = `${parseInt(`${minivodm}`)}`;
         minivodm -= (parseFloat(`${parseInt(`${minivodm}`) * (subsk ? 4 : 2)}`));
         subsk = libreanimatedY.length <= parseInt(`${minivodm}`);
       let modalr: Map<any, any> = new Map([[String.fromCharCode(117,105,110,116,108,101,95,101,95,49,56,0),String.fromCharCode(114,101,102,112,105,99,95,112,95,57,50,0)], [String.fromCharCode(100,101,105,110,116,101,114,108,101,97,118,101,100,95,110,95,53,57,0),String.fromCharCode(117,95,57,54,95,114,103,116,99,0)], [String.fromCharCode(107,95,53,95,116,114,97,110,115,102,101,114,114,105,110,103,0),String.fromCharCode(115,110,110,105,100,95,102,95,55,54,0)]]);
       let libzeusY: Map<any, any> = new Map([[String.fromCharCode(120,95,51,56,95,99,114,111,110,111,115,0),593], [String.fromCharCode(112,107,103,99,111,110,102,105,103,95,108,95,53,50,0),92]]);
       let update_9C = 2;
       let closeU = 5;
      let libreactperfloggerjniA = inviten.length <= 8310867;
      do {
          let bootsplashQ = String.fromCharCode(98,105,116,95,121,95,52,48,0);
          let telegramR = String.fromCharCode(110,95,54,95,108,97,100,100,101,114,115,116,101,112,0);
          let trashe = false;
          let telemetryc = false;
          let combinedP = 2.0;
         inviten = [parseInt(`${gray1}`)];
         bootsplashQ += `${parseInt(`${combinedP}`) | 1}`;
         telegramR += "3";
         trashe = telegramR.length >= 57 && trashe;
         telemetryc = 75 <= telegramR.length;
         combinedP += (bootsplashQ.length & (telemetryc ? 4 : 3));
         if (libreactperfloggerjniA) {
            break;
         }
      } while (((codegenl.size + inviten.length) < 4) && libreactperfloggerjniA);
      for (let x = 0; x < 2; x++) {
         telegramT = [1];
      }
         libzeusY = new Map([[`${mbsplashy}`, (launche == String.fromCharCode(49,0) ? launche.length : (mbsplashy ? 3 : 1))]]);
      if (update_9C > 2) {
         update_9C *= launche.length;
      }
      vignetteg = larged > 70.98 && gray1 > 70.98;
      if (zhuboN) {
         break;
      }
   } while ((!vignetteg && buildE.length < 4) && zhuboN);

            if (result.success === false) {

   while (3 <= orientationo.length) {
      vignetteg = orientationo.length > 16;
      break;
   }
   while (!vignetteg || animationw.length > 4) {
       let dycreatorh = String.fromCharCode(105,95,53,48,95,100,101,99,111,114,114,101,108,97,116,105,111,110,0);
      while (!dycreatorh.startsWith(dycreatorh)) {
          let commentm: Array<any> = [184, 432, 623];
          let pingt = 5.0;
         dycreatorh = `${commentm.length}`;
         commentm = [parseInt(`${pingt}`) / 1];
         pingt /= Math.max(parseInt(`${pingt}`) << (Math.min(Math.abs(parseInt(`${pingt}`)), 5)), 3);
         break;
      }
      if (dycreatorh != dycreatorh) {
         dycreatorh += `${dycreatorh.length / (Math.max(dycreatorh.length, 7))}`;
      }
      if (1 > dycreatorh.length) {
         dycreatorh += `${(dycreatorh == String.fromCharCode(70,0) ? dycreatorh.length : dycreatorh.length)}`;
      }
      vignetteg = (orientationo.length - dices) <= 62;
      break;
   }
      vignetteg = orientationo == String.fromCharCode(56,0);
                throw result.message;
            }

            return result.data;

        } catch (e: any) {
            console.error(`[Error getNativeList}]: ${e.toString()}`);

      buildE = `${1 ^ parseInt(`${direct1}`)}`;
   while (3 <= orientationo.length) {
      orientationo = `${crownm}`;
      break;
   }
   while (4 >= (crownm << (Math.min(animationw.length, 1)))) {
      crownm &= 1;
      break;
   }
            throw e;
        }
    }

    static postValidateReceipt = async ({
        user_id,
        product_id,
        transaction_type,
        zf_channel,
        platform,
        channel_transaction_id,
        transaction_receipt,
        transaction_status,
        is_sb,
    }: {
        user_id: string;
        product_id: string;
        transaction_type: string;
        zf_channel: string;
        platform: string;
        channel_transaction_id: string | undefined;
        transaction_receipt: any;
        transaction_status: number;
        is_sb: number;
    }) => {
        try {
            const isIos = Platform.OS === 'ios';

            const result = await yys_StringsVignette.post(isIos ? yys_FavoriteCustom.productPostValidateReceiptIos : yys_FavoriteCustom.productPostValidateReceiptAndroid, {
                body: {
                    user_id,
                    product_id,
                    transaction_type,
                    zf_channel,
                    platform,
                    channel_transaction_id,
                    transaction_receipt,
                    transaction_status,
                    is_sb,
                }
            });

            if (result.success === false) {
                throw result.message;
            }

            return result;

        } catch (e: any) {
            console.error(`[Error postValidateReceipt}]: ${e.toString()}`);
            throw e;
        }
    }

    static getFinzfTransaction = async ({ transactionId }: { transactionId: string }) => {
        try {
            const result = await yys_StringsVignette.get(yys_FavoriteCustom.productGetFinzfTransaction, {
                query: {
                    transaction_id: transactionId,
                }
            });

            if (result.success === false) {
                throw result.message;
            }

            return result.data;

        } catch (e: any) {
            console.error(`[Error getFinzfTransaction}]: ${e.toString()}`);
            throw e;
        }
    }

    static postFinzfOrder = async ({
        productId,
        zfType,
    }: {
        productId: number;
        zfType: string;
    }) => {
        try {
            const result = await yys_StringsVignette.post(yys_FavoriteCustom.productPostFinzfOrder, {
                body: {
                    product_id: productId,
                    zf_type: zfType,
                    platform: APP_NAME_CONST + "-" + Platform.OS.toUpperCase(),
                    redirect_to: "app",
                }
            });

            if (result.success === false) {
                throw result.message;
            }

            return result.data;

        } catch (e: any) {
            console.error(`[Error postFinzfOrder}]: ${e.toString()}`);
            throw e;
        }
    }

    static postAndroidSubscriptions = async ({
        product_id,
        payment_channel,
        autoRenewingAndroid,
        dataAndroid,
        developerPayloadAndroid,
        isAcknowledgedAndroid,
        obfuscatedAccountIdAndroid,
        obfuscatedProfileIdAndroid,
        packageNameAndroid,
        productId,
        productIds,
        purchaseStateAndroid,
        purchaseToken,
        signatureAndroid,
        transactionDate,
        transactionId,
        transactionReceipt,
    }: {
        product_id: string;
        payment_channel: string;
        autoRenewingAndroid?: boolean;
        dataAndroid?: string;
        developerPayloadAndroid?: string;
        isAcknowledgedAndroid?: boolean;
        obfuscatedAccountIdAndroid?: string;
        obfuscatedProfileIdAndroid?: string;
        packageNameAndroid?: string;
        productId: string;
        productIds?: string[];
        purchaseStateAndroid?: number;
        purchaseToken?: string;
        signatureAndroid?: string;
        transactionDate: number;
        transactionId?: string;
        transactionReceipt: string;
    }) => {
        try {
            const result = await yys_StringsVignette.post(yys_FavoriteCustom.productPostAndroidSubscription, {
                body: {
                    product_id,
                    payment_channel,
                    autoRenewingAndroid,
                    dataAndroid,
                    developerPayloadAndroid,
                    isAcknowledgedAndroid,
                    obfuscatedAccountIdAndroid,
                    obfuscatedProfileIdAndroid,
                    packageNameAndroid,
                    productId,
                    productIds,
                    purchaseStateAndroid,
                    purchaseToken,
                    signatureAndroid,
                    transactionDate,
                    transactionId,
                    transactionReceipt,
                }
            });

            if (result.success === false) {
                throw result.message;
            }

            return result;

        } catch (e: any) {
            console.error(`[Error postAndroidSubscriptions}]: ${e.toString()}`);
            throw e;
        }
    }

    static postAndroidIAP = async ({
        user_id,
        product_id,
        transaction_type,
        zf_channel,
        platform,
        channel_transaction_id,
        transaction_receipt,
        transaction_status,
        is_sb,
        purchase_token,
        package_name_android
    }: {
        user_id: string;
        product_id: string;
        transaction_type: string;
        zf_channel: string;
        platform: string;
        channel_transaction_id: string | undefined;
        transaction_receipt: any;
        transaction_status: number;
        is_sb: number;
        purchase_token?: string;
        package_name_android?: string;
    }) => {
        try {
            const result = await yys_StringsVignette.post(yys_FavoriteCustom.productPostAndroidIAP, {
                body: {
                    user_id,
                    product_id,
                    transaction_type,
                    zf_channel,
                    platform,
                    channel_transaction_id,
                    transaction_receipt,
                    transaction_status,
                    is_sb,
                    purchase_token,
                    package_name_android
                }
            });

            if (result.success === false) {
                throw result.message;
            }

            return result;

        } catch (e: any) {
            console.error(`[Error postAndroidIAP}]: ${e.toString()}`);
            throw e;
        }
    }
}