import React, {memo, useEffect, useState} from 'react';
import {Image, Text, View} from 'react-native';
import DefaultTeamIcon from '../defaultTeamIcon';
import styles from './mayi_iconarrowrightwhite';
import {
  CornerKick,
  Goal,
  PenaltyGoal,
  RedCard,
  YellowCard,
  YellowToRedCard,
} from '../../assets';
import {Colors} from '../../global/mayi_borderless_rocket';
import {CanvasIncident} from './mayi_goal_templateprocessor';

const chartHeight = 40;
const iconHeight = 24;

const EventIcon = {
  1: Goal,
  2: CornerKick,
  3: YellowCard,
  4: RedCard,
  15: YellowToRedCard,
  29: PenaltyGoal,
};

const AreaChart = props => {
       let selection9 = new Map([[String.fromCharCode(115,111,117,110,95,56,95,55,53,0),true ], [String.fromCharCode(112,114,111,112,101,114,116,105,101,115,95,118,95,49,0),false ], [String.fromCharCode(118,95,57,54,95,102,109,115,117,98,0),true ]]);
    let specg = String.fromCharCode(102,95,53,56,95,97,118,117,105,0);
    let moon9 = String.fromCharCode(115,105,103,115,95,52,95,51,0);
    let iconqqu = true;
    let nodeo = 0.0;
    let bgvipxvod7 = String.fromCharCode(106,114,110,108,95,102,95,51,52,0);
    let detailsM = 1;
   do {
      nodeo -= (String.fromCharCode(77,0) == specg ? specg.length : detailsM);
      if (nodeo == 3114316.0) {
         break;
      }
   } while ((nodeo == 3114316.0) && (nodeo < 2.7));

  const {liveRoomUpdate, chartCallback} = props;
   do {
       let storeY = String.fromCharCode(115,117,112,101,114,98,108,111,99,107,115,95,105,95,51,57,0);
      for (let u = 0; u < 2; u++) {
         storeY = `${storeY.length + 1}`;
      }
      while (storeY.length >= storeY.length) {
          let issubu = String.fromCharCode(104,121,112,111,116,104,101,115,101,115,95,113,95,55,55,0);
          let klevinn = [String.fromCharCode(105,95,55,56,0), String.fromCharCode(103,95,55,51,95,103,97,117,103,101,0), String.fromCharCode(115,116,111,112,95,57,95,52,57,0)];
          let upgradeQ = String.fromCharCode(118,101,99,116,95,53,95,54,55,0);
         storeY += "2";
         issubu = `${upgradeQ.length << (Math.min(3, klevinn.length))}`;
         klevinn = [issubu.length];
         upgradeQ = `${klevinn.length}`;
         break;
      }
      if (!storeY.endsWith(storeY)) {
         storeY += `${storeY.length - 3}`;
      }
      selection9 = new Map([[specg, parseInt(`${nodeo}`) + 2]]);
      if (2830530 == selection9.size) {
         break;
      }
   } while ((!Array.from(selection9.keys()).includes(`${nodeo}`)) && (2830530 == selection9.size));

  const [rightContentWidth, setRightContentWidth] = useState(0);
   while ((2 ^ detailsM) < 4) {
      detailsM >>= Math.min(Math.abs((String.fromCharCode(115,0) == moon9 ? detailsM : moon9.length)), 5);
      break;
   }

  

   do {
      moon9 = `${(moon9 == String.fromCharCode(84,0) ? moon9.length : bgvipxvod7.length)}`;
      if (moon9 == String.fromCharCode(117,53,102,111,101,111,106,51,104,0)) {
         break;
      }
   } while ((bgvipxvod7.startsWith(moon9)) && (moon9 == String.fromCharCode(117,53,102,111,101,111,106,51,104,0)));
  

      moon9 = `${parseInt(`${nodeo}`)}`;
  

       let iconfeedbackF = 2;
      while (iconfeedbackF < iconfeedbackF) {
          let videovarw = String.fromCharCode(105,95,52,48,95,111,118,112,97,103,101,0);
          let predictionbuttonD = new Map([[String.fromCharCode(100,101,115,116,105,110,97,116,105,111,110,95,57,95,56,53,0),269], [String.fromCharCode(101,95,55,53,95,114,101,97,100,120,98,108,111,99,107,0),32], [String.fromCharCode(109,100,97,121,95,111,95,50,51,0),829]]);
         iconfeedbackF += 2;
         videovarw = `${predictionbuttonD.size % (Math.max(1, 9))}`;
         predictionbuttonD[videovarw] = 3 & predictionbuttonD.size;
         break;
      }
         iconfeedbackF <<= Math.min(Math.abs(iconfeedbackF), 2);
      for (let c = 0; c < 1; c++) {
         iconfeedbackF >>= Math.min(Math.abs(1), 2);
      }
      iconqqu = iconfeedbackF > 85;
  

      iconqqu = 98 <= detailsM;
  

   for (let g = 0; g < 1; g++) {
      detailsM *= (moon9.length + (iconqqu ? 2 : 1));
   }
  

      specg += `${1 % (Math.max(detailsM, 5))}`;
  

   do {
      bgvipxvod7 = `${parseInt(`${nodeo}`) / 3}`;
      if (String.fromCharCode(113,113,55,49,0) == bgvipxvod7) {
         break;
      }
   } while ((String.fromCharCode(113,113,55,49,0) == bgvipxvod7) && (1 > (selection9.size + 1) && 2 > (1 + selection9.size)));
  

       let trashl = [758, 266];
       let mintegral1 = [264, 56];
       let selectedt = [636, 959, 247];
      while (!mintegral1.includes(selectedt.length)) {
         selectedt = [trashl.length - mintegral1.length];
         break;
      }
         mintegral1 = [trashl.length];
      do {
         mintegral1.push(trashl.length);
         if (mintegral1.length == 1527608) {
            break;
         }
      } while ((mintegral1.length == 1527608) && (4 <= (selectedt.length ^ 1) && (mintegral1.length ^ selectedt.length) <= 1));
      while ((selectedt.length % (Math.max(7, mintegral1.length))) >= 3) {
          let nativea = String.fromCharCode(102,97,117,108,116,95,53,95,53,50,0);
          let defaultfootballbga = 0.0;
          let abidetectt = false;
          let iconeditE = new Map([[String.fromCharCode(102,105,108,116,101,114,95,119,95,52,52,0),true ], [String.fromCharCode(120,95,50,57,95,98,97,99,107,115,112,97,99,101,0),true ], [String.fromCharCode(113,112,101,103,95,120,95,54,51,0),false ]]);
         selectedt = [((abidetectt ? 4 : 5) / (Math.max(selectedt.length, 4)))];
         nativea += "1";
         defaultfootballbga /= Math.max(1, iconeditE.size);
         abidetectt = 10.26 <= defaultfootballbga;
         iconeditE = new Map([[`${iconeditE.size}`, parseInt(`${defaultfootballbga}`) + 1]]);
         break;
      }
      do {
         trashl.push(mintegral1.length - 3);
         if (trashl.length == 1939362) {
            break;
         }
      } while ((trashl.length == 1939362) && ((5 & selectedt.length) >= 2));
          let iconpointscore1 = 4.0;
          let reactnavigationF = 0.0;
          let humidity6 = 2.0;
         trashl = [parseInt(`${reactnavigationF}`)];
         iconpointscore1 /= Math.max(parseFloat(`${3}`), 5);
         reactnavigationF -= parseFloat(`${parseInt(`${humidity6}`) % 3}`);
         humidity6 *= parseFloat(`${parseInt(`${iconpointscore1}`) / 2}`);
         selectedt = [mintegral1.length / (Math.max(3, 6))];
       let benefit0 = String.fromCharCode(121,95,50,95,97,99,99,0);
      if ((3 ^ selectedt.length) > 4) {
          let sharewhiteO = [String.fromCharCode(114,101,102,101,114,101,110,99,101,95,117,95,50,53,0), String.fromCharCode(112,97,103,101,114,95,117,95,51,54,0), String.fromCharCode(105,109,109,101,100,105,97,116,101,115,105,103,110,97,108,95,97,95,49,0)];
          let more4 = 2;
         selectedt = [trashl.length + more4];
         sharewhiteO.push(2);
         more4 <<= Math.min(1, sharewhiteO.length);
      }
      moon9 += `${specg.length << (Math.min(moon9.length, 1))}`;
  

   if (parseInt(`${nodeo}`) == bgvipxvod7.length) {
      nodeo *= selection9.size >> (Math.min(Math.abs(3), 3));
   }
  

      iconqqu = String.fromCharCode(87,0) == specg || 42.20 <= nodeo;
  const home = liveRoomUpdate?.home;
      selection9 = new Map([[moon9, moon9.length]]);

  const away = liveRoomUpdate?.away;
      nodeo -= 1 % (Math.max(parseInt(`${nodeo}`), 3));

  const chartIncident = Array.prototype.filter
    .call(liveRoomUpdate?.football_match_live?.tlive || [], x => x.main === 1)
    .sort((a, b) => {
      if (a.time === b.time) {

      iconqqu = specg.endsWith(`${iconqqu}`);
        return 0;
      } else if (a.time > b.time) {

       let ewarded7 = [958, 130];
       let statisticsx = 5.0;
      for (let g = 0; g < 1; g++) {
          let linkx = [207, 483];
          let classesT = 1.0;
          let turnm = 2;
          let recommendationF = [216, 449];
         ewarded7 = [1];
         linkx.push(linkx.length | parseInt(`${classesT}`));
         classesT /= Math.max(parseFloat(`${parseInt(`${classesT}`)}`), 2);
         turnm += parseInt(`${classesT}`);
         recommendationF = [2];
      }
      do {
         statisticsx /= Math.max(1, 2);
         if (statisticsx == 1955478.0) {
            break;
         }
      } while ((statisticsx == 1955478.0) && (ewarded7.length > 2));
       let modity9 = String.fromCharCode(115,95,50,51,95,100,105,118,105,100,101,114,0);
       let reactnavigationW = String.fromCharCode(117,110,99,104,101,99,107,101,100,95,48,95,54,54,0);
      do {
         modity9 = `${reactnavigationW.length * 2}`;
         if (modity9 == String.fromCharCode(110,103,99,56,103,112,100,108,57,95,0)) {
            break;
         }
      } while ((2 == (ewarded7.length | 2) && 1 == (2 | modity9.length)) && (modity9 == String.fromCharCode(110,103,99,56,103,112,100,108,57,95,0)));
      while (parseInt(`${statisticsx}`) == ewarded7.length) {
          let x_playerm = 0;
          let downloadedd = 2;
         ewarded7 = [x_playerm];
         x_playerm >>= Math.min(4, Math.abs(1 + downloadedd));
         downloadedd <<= Math.min(Math.abs(downloadedd | 3), 5);
         break;
      }
      if (2 > (1 / (Math.max(3, modity9.length))) && (ewarded7.length / 1) > 1) {
         ewarded7.push(parseInt(`${statisticsx}`));
      }
      selection9[`${nodeo}`] = ewarded7.length;
        return 1;
      } else {

   for (let o = 0; o < 3; o++) {
      specg = "2";
   }
        return -1;
   while (iconqqu) {
       let valuesi = false;
      while (!valuesi) {
         valuesi = !valuesi;
         break;
      }
       let frame_1cM = [396, 196, 273];
       let dependencyQ = [638, 616];
         dependencyQ = [(1 - (valuesi ? 5 : 3))];
      iconqqu = String.fromCharCode(48,0) == specg;
      break;
   }

      }
    });
   if (specg.endsWith(`${selection9.size}`)) {
      specg = `${1 << (Math.min(3, Math.abs(selection9.size)))}`;
   }


  const chartData = liveRoomUpdate?.football_match_trend?.data;
       let umengz = 1;
       let nende = String.fromCharCode(113,95,56,50,95,100,101,105,110,116,101,114,108,101,97,118,101,100,0);
       let t_counts = [640, 341, 754];
      while ((nende.length % (Math.max(5, 1))) >= 1) {
         umengz |= t_counts.length * 2;
         break;
      }
       let frame_zf4 = 0.0;
          let rankL = 1;
         t_counts = [t_counts.length];
         rankL *= 3 << (Math.min(1, Math.abs(rankL)));
       let ewardedh = true;
         frame_zf4 += parseFloat(`${t_counts.length - 3}`);
       let frame_uW = 2;
       let weiboI = 0;
      if (3 < (umengz % (Math.max(8, t_counts.length))) || (umengz % 3) < 2) {
         t_counts = [1 ^ t_counts.length];
      }
      while (ewardedh) {
          let giftbuttonD = 4;
          let arrowrightwithtail6 = 2;
          let sell_ = String.fromCharCode(118,105,115,105,116,111,114,95,113,95,53,0);
          let screenD = String.fromCharCode(106,95,55,50,95,97,112,112,108,121,0);
         ewardedh = umengz > arrowrightwithtail6;
         giftbuttonD %= Math.max((screenD == String.fromCharCode(49,0) ? screenD.length : giftbuttonD), 1);
         arrowrightwithtail6 *= sell_.length >> (Math.min(4, Math.abs(giftbuttonD)));
         sell_ += `${3 / (Math.max(1, screenD.length))}`;
         break;
      }
         umengz |= ((ewardedh ? 2 : 3) >> (Math.min(Math.abs(parseInt(`${frame_zf4}`)), 1)));
      moon9 += `${umengz ^ nende.length}`;

  if (!chartData || !chartData.length) {
    chartCallback?.(false);
   for (let z = 0; z < 1; z++) {
      iconqqu = moon9.length >= 3;
   }

    return;
  } else {
    chartCallback?.(true);
      bgvipxvod7 += `${parseInt(`${nodeo}`) % 2}`;

  }

  const time = chartData?.length;
   do {
      specg = `${2 - moon9.length}`;
      if (specg == String.fromCharCode(105,50,120,51,101,105,99,119,100,0)) {
         break;
      }
   } while ((5.73 <= nodeo) && (specg == String.fromCharCode(105,50,120,51,101,105,99,119,100,0)));

  const totalTime = time <= 90 ? 90 : time;
   while (!specg.includes(moon9)) {
      moon9 = `${parseInt(`${nodeo}`)}`;
      break;
   }
 

      detailsM %= Math.max(parseInt(`${nodeo}`) / (Math.max(3, 2)), 1);

  const minutes = [0, 15, 30, 45, 60, 75, totalTime];
      bgvipxvod7 = `${(String.fromCharCode(71,0) == bgvipxvod7 ? detailsM : bgvipxvod7.length)}`;


  

      specg = `${detailsM}`;
  const incidentFilter = incidents => {

      iconqqu = moon9.length == specg.length;
    var allocateTime;
   while (Array.from(selection9.keys()).includes(`${nodeo}`)) {
      selection9[bgvipxvod7] = ((iconqqu ? 3 : 4) % 1);
      break;
   }

    return incidents?.map((x, idx) => {
      const curTime = x.time;
      specg += `${parseInt(`${nodeo}`)}`;

      if (idx > 0) {

   while (4.20 < nodeo && (4.20 * nodeo) < 4.20) {
      nodeo *= selection9.size;
      break;
   }
        if (curTime <= allocateTime) {
          return {...x, allocateTime: ++allocateTime};
        } else {

   if (5.87 >= (5.59 * nodeo)) {
      detailsM -= specg.length;
   }
          allocateTime = curTime;
          return {...x, allocateTime: allocateTime};
        }
      } else {
        allocateTime = curTime;
        return {...x, allocateTime: curTime};
      }
    });
  };
  const filteredHomeIncident = incidentFilter(
    chartIncident?.filter(x => x.position === 1),
  );
  const filteredAwayIncident = incidentFilter(
    chartIncident?.filter(x => x.position === 2),
  );

  
  

  const rightContentlayout = e => {
    setRightContentWidth(e.nativeEvent.layout.width);
  };

  const IncidentIcons = ({data}) => {
    return (
      <View style={{...styles.eventContent}}>
        {data?.map((e, index) => {
          const size = e.type === 1 || e.type === 29 ? 8 : 10;
          return (
            <Image
              key={`filteredHomeIncident-${index}`}
              style={{
                width: size,
                height: size,
                position: 'absolute',
                left: (rightContentWidth * e.allocateTime) / totalTime,
                transform: [{translateX: -size / 2}],
              }}
              source={EventIcon[e.type] || ''}
              resizeMode={'contain'}></Image>
          );
        })}
      </View>
    );
  };
  return (
    <View style={styles.container}>
      <View style={styles.rowContent}>
        <View style={styles.leftContent}></View>
        <View
          style={[styles.rightContent, {height: iconHeight}]}
          onLayout={rightContentlayout}>
          <View
            style={{
              position: 'relative',
              flexDirection: 'row',
              paddingBottom: 10,
            }}>
            {minutes.map((e, index) => {
              return (
                <Text
                  key={`footBallAreaChartMinute-${index}`}
                  style={[
                    styles.minuteText,
                    {
                      width: 400,
                      textAlign: 'center',
                      position: 'absolute',
                      left: (e / totalTime) * rightContentWidth,
                      transform: [{translateX: -200}],
                    },
                  ]}>
                  {e === 45 ? 'HT' : ` ${e}'`}
                </Text>
              );
            })}
          </View>
          {/* Home Incident */}
          <IncidentIcons data={filteredHomeIncident || []} />
        </View>
      </View>
      <View style={styles.rowContent}>
        <View style={styles.leftContent}>
          {home?.icon ? (
            <Image style={styles.teamIcon} source={{uri: home?.icon}}></Image>
          ) : (
            <DefaultTeamIcon iconSize={20} isHome={true} text={home?.name} />
          )}
          {away?.icon ? (
            <Image style={styles.teamIcon} source={{uri: away?.icon}}></Image>
          ) : (
            <DefaultTeamIcon iconSize={20} isHome={false} text={away?.name} />
          )}
        </View>
        <View style={[styles.rightContent, {height: chartHeight}]}>
          <View style={{position: 'relative'}}>
            {/* 背景颜色 */}
            <View
              style={{
                position: 'absolute',
                height: chartHeight,
                width: rightContentWidth,
              }}>
              <View
                style={{
                  position: 'absolute',
                  top: 0,
                  bottom: '50%',
                  left: 0,
                  right: 0,
                  backgroundColor: 'rgb(38, 39, 42)',
                }}></View>
              <View
                style={{
                  position: 'absolute',
                  top: '50%',
                  bottom: 0,
                  left: 0,
                  right: 0,
                  backgroundColor: 'rgb(38, 39, 42)',
                }}></View>
            </View>
            {/* 时间指标 */}
            <View
              style={{
                position: 'absolute',
                height: chartHeight,
                width: 1,
                zIndex: 99,
                backgroundColor: Colors.colorPrimary,
                left: (time / totalTime) * rightContentWidth + 1,
              }}
            />
            <CanvasIncident
              data={chartData}
              height={chartHeight}
              width={(time / totalTime) * rightContentWidth}
            />
          </View>
        </View>
      </View>
      <View style={styles.rowContent}>
        <View style={styles.leftContent}></View>
        <View style={[styles.rightContent, {height: iconHeight}]}>
          {/* Away Incident */}
          <IncidentIcons data={filteredAwayIncident || []} />
        </View>
      </View>
    </View>
  );
};

export default memo(AreaChart);
