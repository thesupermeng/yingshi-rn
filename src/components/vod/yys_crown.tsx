import {useEffect, useRef, useState} from 'react';
import {StyleSheet, TouchableOpacity, Image, ViewStyle} from 'react-native';
import {useNavigation, useTheme} from '@react-navigation/native';
import {useQuery} from '@tanstack/react-query';
import {yys_Bing} from '@type/yys_libzeus';
import VodCard from './yys_singapore';
import {useAppDispatch} from '@hooks/yys_frame';
import {playVod} from '@redux/actions/yys_player_style';
import {yys_CountdownSubmit} from '@redux/reducers/yys_full';
import {FlatList} from 'react-native-gesture-handler';
interface yys_ConfigureUimanager {
  params?: any[];
  vodStyle?: ViewStyle;
  horizontal?: boolean;
  vodList?: Array<yys_CountdownSubmit>;
  showInfo?: 'none' | 'watch_progress';
  isRefreshing?: boolean;
}

type yys_Controls = {
  list: Array<yys_CountdownSubmit>;
};

type yys_Mbsplash = {
  item: yys_CountdownSubmit;
};
export default function VodHistoryList({
  vodStyle,
  horizontal = true,
  vodList = [],
  showInfo = 'none',
  isRefreshing = false,
}: yys_ConfigureUimanager) {
  const navigation = useNavigation();
  const dispatch = useAppDispatch();

  const historyRef = useRef<FlatList>(null);

  const resetListPositionHandler = () => {
       let logoutK = false;
    let settinga = String.fromCharCode(112,97,110,101,115,95,102,95,51,53,0);
    let googleq = String.fromCharCode(100,101,102,101,114,114,105,110,103,95,119,95,53,49,0);
    let icon4: Array<any> = [625, 460, 517];
    let largek = String.fromCharCode(117,110,107,101,121,101,100,95,112,95,56,57,0);
    let interstitiala = true;
    let questl = String.fromCharCode(99,95,53,52,95,97,98,111,117,116,0);
    let shooty = String.fromCharCode(104,95,53,51,95,115,116,114,117,99,116,0);
    let termsk = String.fromCharCode(119,104,105,116,101,108,105,115,116,101,100,95,113,95,53,51,0);
    let trophyJ: Array<any> = [538, 58];
    let tickc = String.fromCharCode(110,111,105,110,100,101,120,95,114,95,51,54,0);
    let regeng7 = true;
    let string9 = 1.0;
    let phoneH: Map<any, any> = new Map([[String.fromCharCode(99,111,110,118,101,114,115,105,111,110,95,100,95,49,0),955], [String.fromCharCode(116,120,105,100,95,98,95,55,54,0),300], [String.fromCharCode(108,111,99,97,116,105,111,110,115,95,54,95,49,52,0),635]]);
    let untickG = 5.0;
       let mimoF = true;
          let turny = String.fromCharCode(110,95,57,49,95,119,101,114,101,0);
          let hearta = 2;
         mimoF = (((mimoF ? turny.length : 10) >> (Math.min(turny.length, 4))) <= 10);
         hearta <<= Math.min(Math.abs(hearta), 1);
       let libfbk = String.fromCharCode(99,95,57,54,95,116,104,114,101,97,100,115,0);
      let zoomR = mimoF ? !mimoF : mimoF;
      do {
         mimoF = !mimoF;
         if (zoomR) {
            break;
         }
      } while (zoomR && (libfbk.length == 5 && !mimoF));
      settinga = `${settinga.length}`;
   if (termsk == String.fromCharCode(82,0)) {
      largek = `${trophyJ.length & icon4.length}`;
   }
      trophyJ.push(largek.length - tickc.length);
   while (settinga != tickc) {
      tickc += `${googleq.length}`;
      break;
   }
   if (regeng7) {
       let entryG = 0.0;
       let bdxadsdkK = String.fromCharCode(105,119,104,116,95,107,95,52,52,0);
       let event9 = String.fromCharCode(117,112,108,111,97,100,105,110,103,95,54,95,56,57,0);
       let controlP = 2.0;
       let runtimescheduler5 = String.fromCharCode(115,116,114,105,112,115,95,110,95,52,57,0);
         entryG -= 3;
      for (let a = 0; a < 2; a++) {
         controlP -= 2;
      }
      if (4.61 > controlP) {
         controlP -= bdxadsdkK.length;
      }
      while (entryG == event9.length) {
         entryG -= runtimescheduler5.length << (Math.min(Math.abs(1), 2));
         break;
      }
      if ((entryG / (Math.max(2, controlP))) > 1.75 && 5.86 > (controlP / 1.75)) {
          let sellU = String.fromCharCode(98,105,110,100,108,105,115,116,95,50,95,52,52,0);
         controlP /= Math.max(2, bdxadsdkK.length - event9.length);
         sellU = `${sellU.length}`;
      }
      let become8 = bdxadsdkK.length >= 8051471;
      do {
         bdxadsdkK = `${parseInt(`${entryG}`)}`;
         if (become8) {
            break;
         }
      } while (((parseInt(`${entryG}`) - bdxadsdkK.length) == 5 && 1 == (parseInt(`${entryG}`) - 5)) && become8);
       let launchx = String.fromCharCode(114,97,98,98,105,116,95,98,95,52,51,0);
      let sentryx = bdxadsdkK == String.fromCharCode(117,121,113,48,56,119,111,112,103,0);
      do {
         bdxadsdkK += "3";
         if (sentryx) {
            break;
         }
      } while (sentryx && (event9 == String.fromCharCode(119,0)));
      for (let d = 0; d < 2; d++) {
         controlP *= parseInt(`${controlP}`) / 2;
      }
          let mailu = true;
          let stationG: Array<any> = [800, 432, 180];
          let robotok = String.fromCharCode(97,95,54,50,95,98,102,114,97,109,101,115,0);
         event9 += `${1 - launchx.length}`;
         mailu = (78 > (robotok.length | (!mailu ? 78 : robotok.length)));
         stationG = [robotok.length];
      if (5.72 > (controlP * 5.67) || (4 ^ runtimescheduler5.length) > 4) {
          let flipperP: Map<any, any> = new Map([[String.fromCharCode(117,115,101,114,99,116,120,95,106,95,55,57,0),false ], [String.fromCharCode(105,95,50,56,95,108,101,118,97,114,105,110,116,0),true ]]);
          let stringsL = 4.0;
          let incidentj = 5;
          let reminderL = true;
          let runtimeL = 1.0;
         runtimescheduler5 = `${event9.length / (Math.max(3, 10))}`;
         flipperP = new Map([[`${incidentj}`, 2 * incidentj]]);
         stringsL -= parseFloat(`${parseInt(`${runtimeL}`)}`);
         reminderL = parseFloat(`${incidentj}`) == stringsL;
         runtimeL += incidentj;
      }
          let bdxadsdkY = String.fromCharCode(116,111,107,101,110,100,95,107,95,57,50,0);
          let launcherN = String.fromCharCode(98,95,55,54,95,115,112,101,114,97,116,111,114,0);
         launchx += `${parseInt(`${entryG}`) + 2}`;
         bdxadsdkY += `${launcherN.length}`;
         launcherN += `${bdxadsdkY.length >> (Math.min(Math.abs(1), 2))}`;
          let volumex = 0.0;
          let storee: Array<any> = [409, 905, 402];
          let path0 = 5.0;
         bdxadsdkK = `${parseInt(`${path0}`) >> (Math.min(2, Math.abs(1)))}`;
         volumex += parseInt(`${volumex}`) / 2;
         storee = [storee.length];
         path0 *= parseFloat(`${storee.length}`);
      for (let r = 0; r < 3; r++) {
         event9 = `${launchx.length}`;
      }
      let becomew = launchx == String.fromCharCode(121,122,122,120,106,116,122,105,48,118,0);
      do {
         launchx += `${launchx.length}`;
         if (becomew) {
            break;
         }
      } while (((entryG * launchx.length) < 3.17 && 4 < (2 | launchx.length)) && becomew);
      googleq = `${runtimescheduler5.length + icon4.length}`;
   }
       let snewarchdefaultsE = false;
         snewarchdefaultsE = !snewarchdefaultsE;
      let dialogf = snewarchdefaultsE ? !snewarchdefaultsE : snewarchdefaultsE;
      do {
         snewarchdefaultsE = !snewarchdefaultsE;
         if (dialogf) {
            break;
         }
      } while (dialogf && (snewarchdefaultsE));
         snewarchdefaultsE = !snewarchdefaultsE;
      trophyJ.push(tickc.length << (Math.min(Math.abs(1), 5)));
      regeng7 = 63 < shooty.length && 63 < trophyJ.length;
   if (3 >= trophyJ.length) {
       let sellr = false;
       let sigmobC = String.fromCharCode(99,95,51,95,114,101,110,100,101,114,101,114,115,0);
       let materialy = String.fromCharCode(109,111,110,105,116,111,114,95,112,95,52,57,0);
         materialy = `${sigmobC.length + 1}`;
          let middle_ = String.fromCharCode(110,97,99,107,95,56,95,49,53,0);
          let nativeP = String.fromCharCode(99,102,102,116,98,95,100,95,52,52,0);
         materialy = `${3 & nativeP.length}`;
         middle_ += `${middle_.length}`;
         nativeP += `${1 << (Math.min(1, middle_.length))}`;
      while (sellr) {
         sellr = !sellr;
         break;
      }
      for (let v = 0; v < 1; v++) {
         sellr = materialy == sigmobC;
      }
       let combineu = String.fromCharCode(100,95,55,56,95,97,118,99,111,100,101,99,114,101,115,0);
       let libavdeviceV = String.fromCharCode(112,98,107,100,102,95,56,95,50,49,0);
         materialy = `${combineu.length >> (Math.min(1, materialy.length))}`;
      let controlt = combineu.length >= 9059005;
      do {
          let libcxxcomponents7 = false;
          let libsentryp = 0.0;
          let sportH: Map<any, any> = new Map([[String.fromCharCode(110,95,56,57,95,105,108,111,103,0),false ], [String.fromCharCode(117,110,116,114,97,99,107,95,113,95,50,55,0),true ]]);
          let controlI = String.fromCharCode(111,109,112,108,105,99,97,116,105,111,110,95,114,95,53,48,0);
         combineu += `${libavdeviceV.length}`;
         libcxxcomponents7 = sportH.size == 26;
         libsentryp /= Math.max(2, parseFloat(`${controlI.length}`));
         sportH = new Map([[`${sportH.size}`, controlI.length << (Math.min(Math.abs(2), 1))]]);
         if (controlt) {
            break;
         }
      } while ((!combineu.includes(`${libavdeviceV.length}`)) && controlt);
      for (let y = 0; y < 3; y++) {
         sigmobC = `${(String.fromCharCode(116,0) == libavdeviceV ? materialy.length : libavdeviceV.length)}`;
      }
      let downI = String.fromCharCode(57,51,55,52,115,50,0) == combineu;
      do {
         combineu += `${sigmobC.length | materialy.length}`;
         if (downI) {
            break;
         }
      } while (downI && (!combineu.startsWith(`${materialy.length}`)));
      shooty += `${(1 + (logoutK ? 3 : 4))}`;
   }
      settinga += `${2 ^ googleq.length}`;
   let bridge5 = regeng7 ? !regeng7 : regeng7;
   do {
      regeng7 = logoutK || tickc.length > 60;
      if (bridge5) {
         break;
      }
   } while ((5 <= largek.length) && bridge5);

    historyRef?.current?.scrollToIndex({
      index: 0,
      animated: false,
    });
  };

  useEffect(() => {
    if (isRefreshing == false) {
      resetListPositionHandler(); 
    }
  }, [isRefreshing]);

  return (
    <FlatList
      ref={historyRef}
      data={vodList}
      horizontal
      showsHorizontalScrollIndicator={false}
      keyExtractor={(item) => item.vod_id.toString()}
      renderItem={({item, index}: yys_Mbsplash) => {
        return (
          <VodCard
            showPlayIcon={true}
            vodImageStyle={vodStyle}
            shadowBottom={true}
            vod_name={item.vod_name}
            vod_pic={item.vod_pic}
            showInfo={
              showInfo === 'none'
                ? ''
                : `观看至 ${new Date(1000 * item.timeWatched)
                    .toISOString()
                    .substr(11, 8)}`
            }
            onPress={() => {
              dispatch(playVod(item));
              navigation.navigate('播放', {vod_id: item.vod_id});
            }}
            index={index}
          />
        );
      }}
    />
  );
}

const styles = StyleSheet.create({});
