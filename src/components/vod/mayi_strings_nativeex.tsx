import {useEffect, useRef, useState} from 'react';
import {StyleSheet, TouchableOpacity, Image, ViewStyle} from 'react-native';
import {useNavigation, useTheme} from '@react-navigation/native';
import {useQuery} from '@tanstack/react-query';
import {mayi_EmptyGradle} from '@type/mayi_green';
import VodCard from './mayi_pressure_footballfiledlayout';
import {useAppDispatch} from '@hooks/mayi_redirect';
import {playVod} from '@redux/actions/mayi_goallogo';
import {mayi_FileBrightness} from '@redux/reducers/mayi_temp_holder';
import {FlatList} from 'react-native-gesture-handler';
interface mayi_GoogleViews {
  params?: any[];
  vodStyle?: ViewStyle;
  horizontal?: boolean;
  vodList?: Array<mayi_FileBrightness>;
  showInfo?: 'none' | 'watch_progress';
  isRefreshing?: boolean;
}

type mayi_Away = {
  list: Array<mayi_FileBrightness>;
};

type mayi_EventLibnms = {
  item: mayi_FileBrightness;
};
export default function VodHistoryList({
  vodStyle,
  horizontal = true,
  vodList = [],
  showInfo = 'none',
  isRefreshing = false,
}: mayi_GoogleViews) {
  const navigation = useNavigation();
  const dispatch = useAppDispatch();

  const historyRef = useRef<FlatList>(null);

  const resetListPositionHandler = () => {
       let watchN = 3;
    let currenth = String.fromCharCode(100,101,115,116,111,114,121,95,114,95,57,51,0);
    let bgvipxvodZ: Array<any> = [479, 254, 922];
    let buildn = 2.0;
    let vignette6 = false;
    let miniW = String.fromCharCode(109,97,112,112,105,110,103,95,50,95,57,0);
    let coreG: Map<any, any> = new Map([[String.fromCharCode(97,100,100,105,110,103,95,54,95,53,55,0),422], [String.fromCharCode(114,101,116,117,114,110,115,95,100,95,55,54,0),625]]);
    let trophyH = 5;
    let styleL = String.fromCharCode(106,95,56,50,95,115,105,103,104,0);
    let homeloading9: Array<any> = [468, 880, 770];
   let optionsh = currenth == String.fromCharCode(56,100,107,108,0);
   do {
      currenth += `${parseInt(`${buildn}`)}`;
      if (optionsh) {
         break;
      }
   } while (optionsh && (!currenth.includes(`${buildn}`)));
   if (3 > miniW.length) {
      miniW += `${bgvipxvodZ.length}`;
   }
       let questO = String.fromCharCode(116,119,111,115,95,110,95,49,56,0);
       let typesm = false;
       let watchr = String.fromCharCode(115,97,109,112,108,101,114,101,100,117,99,116,105,111,110,95,119,95,51,50,0);
         watchr = `${watchr.length}`;
       let bgvipxvod4: Array<any> = [66, 164];
       let nterstitialf: Array<any> = [979, 451];
      if (watchr.length > bgvipxvod4.length) {
         bgvipxvod4 = [2 & watchr.length];
      }
      while (5 == (3 - bgvipxvod4.length) && 2 == (3 - bgvipxvod4.length)) {
         watchr = "3";
         break;
      }
          let descf = String.fromCharCode(102,95,56,54,95,98,108,111,99,107,115,99,97,110,0);
         typesm = 70 >= bgvipxvod4.length || questO == String.fromCharCode(115,0);
         descf += `${descf.length | descf.length}`;
         nterstitialf = [bgvipxvod4.length];
          let backwhiteC = 1;
          let mountingG = 4.0;
         nterstitialf = [nterstitialf.length / 2];
         backwhiteC |= 2 * parseInt(`${mountingG}`);
         mountingG /= Math.max(3, parseInt(`${mountingG}`));
       let subinX: Map<any, any> = new Map([[String.fromCharCode(99,97,114,114,105,101,114,95,54,95,57,53,0),String.fromCharCode(108,95,54,52,95,116,114,97,99,101,0)], [String.fromCharCode(110,101,116,119,111,114,107,95,56,95,56,56,0),String.fromCharCode(115,104,97,100,101,114,95,54,95,56,50,0)]]);
       let shirtV: Map<any, any> = new Map([[String.fromCharCode(115,95,55,95,97,108,101,114,116,115,0),813], [String.fromCharCode(120,95,57,54,95,104,111,115,116,115,0),835]]);
      if (watchr.endsWith(`${subinX.size}`)) {
         subinX = new Map([[`${shirtV.size}`, 1 & nterstitialf.length]]);
      }
      watchN %= Math.max(1, bgvipxvodZ.length ^ 1);
   for (let e = 0; e < 2; e++) {
       let iconpointscore5 = 4.0;
       let league_ = String.fromCharCode(116,95,52,48,95,118,105,110,116,101,114,112,111,108,97,116,111,114,0);
       let orangedownarrowW: Array<any> = [377, 952];
       let iconwatch7: Map<any, any> = new Map([[String.fromCharCode(97,95,51,56,95,100,105,109,101,110,115,105,111,110,0),350], [String.fromCharCode(97,114,99,116,105,99,95,112,95,52,0),215], [String.fromCharCode(120,95,49,51,95,115,112,101,101,100,111,109,101,116,101,114,0),524]]);
      let rewardC = league_.length >= 5595196;
      do {
         league_ = `${orangedownarrowW.length / 3}`;
         if (rewardC) {
            break;
         }
      } while ((league_.startsWith(`${iconpointscore5}`)) && rewardC);
         league_ += `${parseInt(`${iconpointscore5}`)}`;
          let iconlogouts = 3;
         league_ += `${iconwatch7.size - 2}`;
         iconlogouts /= Math.max(iconlogouts * iconlogouts, 5);
         league_ = "1";
      if (4 <= (league_.length << (Math.min(2, Math.abs(iconwatch7.size)))) || 4 <= (league_.length << (Math.min(3, Math.abs(iconwatch7.size))))) {
         iconwatch7.set(`${iconpointscore5}`, parseInt(`${iconpointscore5}`) % 3);
      }
      while (1 < (league_.length + orangedownarrowW.length)) {
         league_ += `${3 | league_.length}`;
         break;
      }
         orangedownarrowW.push(orangedownarrowW.length);
         iconwatch7.set(`${iconpointscore5}`, parseInt(`${iconpointscore5}`));
      for (let o = 0; o < 1; o++) {
         league_ = `${parseInt(`${iconpointscore5}`)}`;
      }
          let telemetry8 = String.fromCharCode(116,95,49,51,95,100,98,115,116,97,116,0);
          let alertq: Map<any, any> = new Map([[String.fromCharCode(117,95,57,56,95,112,102,105,108,116,101,114,0),String.fromCharCode(109,105,110,117,116,101,95,97,95,50,48,0)], [String.fromCharCode(114,101,115,111,108,117,116,105,111,110,95,112,95,56,54,0),String.fromCharCode(115,116,114,112,116,105,109,101,95,107,95,57,55,0)]]);
          let iconsettingt = String.fromCharCode(112,114,111,109,105,115,101,115,95,53,95,50,55,0);
         iconpointscore5 -= parseFloat(`${2}`);
         telemetry8 = `${iconsettingt.length}`;
         alertq.set(telemetry8, telemetry8.length - iconsettingt.length);
      let mergerR = 8063863 <= league_.length;
      do {
         league_ = `${orangedownarrowW.length % 2}`;
         if (mergerR) {
            break;
         }
      } while (mergerR && (2.12 == iconpointscore5));
      if (orangedownarrowW.length <= 1) {
         orangedownarrowW = [parseInt(`${iconpointscore5}`)];
      }
      vignette6 = bgvipxvodZ.includes(vignette6);
   }
   for (let u = 0; u < 1; u++) {
      buildn /= Math.max(5, parseFloat(`${bgvipxvodZ.length ^ 1}`));
   }
   while (bgvipxvodZ.length <= 2 || 3 <= (bgvipxvodZ.length % (Math.max(2, 5)))) {
       let live4 = String.fromCharCode(110,95,51,53,95,115,101,114,118,105,99,101,0);
       let vinit_tu: Map<any, any> = new Map([[String.fromCharCode(103,95,54,55,95,102,114,97,109,101,115,0),String.fromCharCode(111,95,51,48,95,114,101,112,114,101,115,101,110,116,115,0)], [String.fromCharCode(122,95,51,53,95,107,105,99,107,101,114,0),String.fromCharCode(120,95,57,54,95,98,97,115,105,115,0)]]);
       let albumn = String.fromCharCode(110,95,56,95,110,101,103,97,116,105,118,101,0);
      while (live4.includes(`${vinit_tu.size}`)) {
         vinit_tu = new Map([[`${vinit_tu.size}`, (live4 == String.fromCharCode(69,0) ? vinit_tu.size : live4.length)]]);
         break;
      }
      while ((live4.length + vinit_tu.size) < 5 && 5 < (5 + live4.length)) {
         vinit_tu = new Map([[`${vinit_tu.size}`, vinit_tu.size & live4.length]]);
         break;
      }
         live4 = `${vinit_tu.size - albumn.length}`;
      while (2 <= (2 - vinit_tu.size) || 2 <= (vinit_tu.size - live4.length)) {
          let ajaxE: Array<any> = [String.fromCharCode(120,95,50,57,95,99,111,109,112,114,101,115,115,105,111,110,0), String.fromCharCode(104,95,54,53,95,102,97,105,108,117,114,101,0), String.fromCharCode(115,116,105,112,112,101,100,95,99,95,52,52,0)];
         live4 += "3";
         ajaxE.push(ajaxE.length);
         break;
      }
         albumn = `${vinit_tu.size / (Math.max(albumn.length, 6))}`;
      bgvipxvodZ = [bgvipxvodZ.length];
      break;
   }
      buildn += parseFloat(`${parseInt(`${buildn}`)}`);
       let cancel3: Array<any> = [String.fromCharCode(101,95,56,56,95,97,108,101,114,116,115,0), String.fromCharCode(108,115,112,108,112,99,95,108,95,53,49,0), String.fromCharCode(99,104,97,114,116,115,95,122,95,55,56,0)];
       let register_j8 = 3.0;
       let uploadR = true;
       let humidityN = false;
         cancel3.push(cancel3.length);
         register_j8 -= (parseFloat(`${3 | (uploadR ? 2 : 5)}`));
          let reads = 5;
          let libyogaR = 2.0;
          let yellowcirclebg5: Array<any> = [249, 574];
         cancel3.push(reads);
         reads -= parseInt(`${libyogaR}`);
         libyogaR += yellowcirclebg5.length;
         yellowcirclebg5 = [2];
         uploadR = 46.91 < register_j8 && uploadR;
         humidityN = cancel3.length > 53 || !uploadR;
      buildn /= Math.max(1, parseFloat(`${watchN}`));

    historyRef?.current?.scrollToIndex({
      index: 0,
      animated: false,
    });
  };

  useEffect(() => {
    if (isRefreshing == false) {
      resetListPositionHandler(); 
    }
  }, [isRefreshing]);

  return (
    <FlatList
      ref={historyRef}
      data={vodList}
      horizontal
      showsHorizontalScrollIndicator={false}
      keyExtractor={(item) => item.vod_id.toString()}
      renderItem={({item, index}: mayi_EventLibnms) => {
        return (
          <VodCard
            showPlayIcon={true}
            vodImageStyle={vodStyle}
            shadowBottom={true}
            vod_name={item.vod_name}
            vod_pic={item.vod_pic}
            showInfo={
              showInfo === 'none'
                ? ''
                : `观看至 ${new Date(1000 * item.timeWatched)
                    .toISOString()
                    .substr(11, 8)}`
            }
            onPress={() => {
              dispatch(playVod(item));
              navigation.navigate('播放', {vod_id: item.vod_id});
            }}
            index={index}
          />
        );
      }}
    />
  );
}

const styles = StyleSheet.create({});
