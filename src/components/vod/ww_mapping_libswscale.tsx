import {useEffect, useRef, useState} from 'react';
import {StyleSheet, TouchableOpacity, Image, ViewStyle} from 'react-native';
import {useNavigation, useTheme} from '@react-navigation/native';
import {useQuery} from '@tanstack/react-query';
import {wwControl} from '@type/ww_dycreator_result';
import VodCard from './ww_accepted_current';
import {useAppDispatch} from '@hooks/ww_catagory_neon';
import {playVod} from '@redux/actions/ww_floater';
import {wwYellowredcardRelease} from '@redux/reducers/ww_shared';
import {FlatList} from 'react-native-gesture-handler';
interface wwIndexDice {
  params?: any[];
  vodStyle?: ViewStyle;
  horizontal?: boolean;
  vodList?: Array<wwYellowredcardRelease>;
  showInfo?: 'none' | 'watch_progress';
  isRefreshing?: boolean;
}

type wwVolumePrivate = {
  list: Array<wwYellowredcardRelease>;
};

type wwCasting = {
  item: wwYellowredcardRelease;
};
export default function VodHistoryList({
  vodStyle,
  horizontal = true,
  vodList = [],
  showInfo = 'none',
  isRefreshing = false,
}: wwIndexDice) {
  const navigation = useNavigation();
  const dispatch = useAppDispatch();

  const historyRef = useRef<FlatList>(null);

  const resetListPositionHandler = () => {
       let backwardH = 1.0;
    let iconediti = 0.0;
    let robotoh = 4;
    let encryptm = 3.0;
    let iconwechatK = String.fromCharCode(98,97,99,107,112,116,114,95,115,95,50,51,0);
    let readu = String.fromCharCode(110,108,115,116,95,54,95,54,50,0);
    let championR = String.fromCharCode(118,105,101,119,95,102,95,49,56,0);
    let tempV = String.fromCharCode(115,95,54,55,95,115,101,99,0);
    let mbjscommonT = true;
    let bnews7 = 2.0;
       let aboutY = String.fromCharCode(120,95,49,51,95,113,117,97,100,114,0);
       let phone5: Array<any> = [637, 160];
      let serviceM = phone5.length <= 5678983;
      do {
         phone5 = [aboutY.length ^ phone5.length];
         if (serviceM) {
            break;
         }
      } while ((aboutY.length == 1) && serviceM);
      while (phone5.length == aboutY.length) {
         aboutY += `${3 & phone5.length}`;
         break;
      }
          let playercommonJ: Map<any, any> = new Map([[String.fromCharCode(114,95,52,51,95,115,101,116,114,97,110,103,101,0),String.fromCharCode(121,95,53,57,95,115,111,102,116,119,97,114,101,0)], [String.fromCharCode(122,95,51,50,95,116,111,107,101,110,105,122,101,114,0),String.fromCharCode(106,95,51,56,95,105,109,112,114,105,110,116,0)], [String.fromCharCode(115,116,101,112,112,101,100,95,103,95,52,55,0),String.fromCharCode(98,117,99,107,101,116,115,95,55,95,51,54,0)]]);
          let giflivestreamingu = String.fromCharCode(101,95,50,56,95,112,114,101,104,101,97,116,0);
          let bootsplashN: Map<any, any> = new Map([[String.fromCharCode(101,95,53,53,95,99,111,110,116,114,97,115,116,0),true ], [String.fromCharCode(107,105,110,103,102,105,115,104,101,114,95,118,95,49,0),true ], [String.fromCharCode(100,95,53,51,95,102,97,114,109,101,0),true ]]);
         aboutY += `${phone5.length}`;
         playercommonJ = new Map([[`${bootsplashN.size}`, 1]]);
         giflivestreamingu += `${bootsplashN.size << (Math.min(giflivestreamingu.length, 1))}`;
       let bingo = String.fromCharCode(111,95,55,50,95,114,101,102,112,108,97,110,101,0);
      let assistS = bingo.length <= 7158753;
      do {
          let nbatrophyr = 0.0;
         bingo += `${2 / (Math.max(8, parseInt(`${nbatrophyr}`)))}`;
         if (assistS) {
            break;
         }
      } while ((1 < (1 << (Math.min(2, phone5.length)))) && assistS);
         aboutY = `${2 * bingo.length}`;
      iconwechatK = "3";
   for (let n = 0; n < 2; n++) {
       let alerti = 4.0;
          let iconnewsshareJ = String.fromCharCode(120,95,55,52,95,116,97,103,103,105,110,103,0);
          let fnewarchdefaultse = 2.0;
         alerti += parseFloat(`${iconnewsshareJ.length}`);
         iconnewsshareJ = `${parseInt(`${fnewarchdefaultse}`)}`;
         alerti += parseFloat(`${parseInt(`${alerti}`) * 3}`);
         alerti /= Math.max(parseFloat(`${parseInt(`${alerti}`)}`), 4);
      tempV += `${((mbjscommonT ? 2 : 3) & parseInt(`${alerti}`))}`;
   }
      encryptm *= parseFloat(`${tempV.length % (Math.max(3, 9))}`);
   if (4 == championR.length) {
      championR += `${parseInt(`${encryptm}`) % 3}`;
   }
       let hook1 = false;
      while (!hook1) {
         hook1 = !hook1;
         break;
      }
         hook1 = (!hook1 ? hook1 : !hook1);
         hook1 = !hook1 && hook1;
      championR += `${tempV.length % (Math.max(3, 1))}`;
      readu += `${readu.length}`;
       let mimo3: Map<any, any> = new Map([[String.fromCharCode(118,95,55,54,95,97,100,100,101,114,0),String.fromCharCode(107,95,51,56,95,112,101,114,105,111,100,105,99,97,108,108,121,0)], [String.fromCharCode(114,111,119,107,101,121,95,49,95,53,55,0),String.fromCharCode(121,95,54,48,95,108,105,98,106,112,101,103,116,117,114,98,111,0)]]);
       let turnH: Array<any> = [128, 874, 791];
       let nalyticsm = String.fromCharCode(109,117,108,116,105,112,97,114,116,95,107,95,50,51,0);
      while ((4 + nalyticsm.length) > 5) {
          let circleT = String.fromCharCode(111,100,101,114,110,95,117,95,49,50,0);
         nalyticsm = `${circleT.length + mimo3.size}`;
         break;
      }
       let filledD = String.fromCharCode(110,95,53,49,95,115,121,110,116,104,101,115,105,122,101,114,0);
       let reactnativeultimatelistviewp = String.fromCharCode(117,110,108,105,109,105,116,101,100,95,117,95,54,50,0);
       let yellowvideoliveO = 3.0;
      for (let q = 0; q < 1; q++) {
          let flipperM = String.fromCharCode(112,114,111,109,105,115,101,95,117,95,56,48,0);
          let dangeru = String.fromCharCode(112,114,101,109,117,108,116,115,116,114,97,105,103,104,116,95,119,95,49,51,0);
          let orange0: Array<any> = [88, 553];
          let playlistk = String.fromCharCode(97,100,100,105,116,105,111,110,95,51,95,51,51,0);
          let gemfile4 = 4;
         turnH = [3 * reactnativeultimatelistviewp.length];
         flipperM += "1";
         dangeru += `${flipperM.length % 3}`;
         orange0 = [1];
         playlistk += `${(String.fromCharCode(85,0) == flipperM ? flipperM.length : dangeru.length)}`;
         gemfile4 -= gemfile4 << (Math.min(Math.abs(1), 3));
      }
      if (2 < (mimo3.size + 4) && 4 < (mimo3.size + reactnativeultimatelistviewp.length)) {
         reactnativeultimatelistviewp = `${parseInt(`${yellowvideoliveO}`) / 3}`;
      }
         nalyticsm += `${mimo3.size / 1}`;
          let arrowI = false;
          let headeru = 4.0;
         turnH = [3 * nalyticsm.length];
         arrowI = headeru == 72.30 && !arrowI;
         headeru /= Math.max(5, (parseInt(`${headeru}`) * (arrowI ? 3 : 4)));
      while (1.79 == (5.69 / (Math.max(2, yellowvideoliveO)))) {
         reactnativeultimatelistviewp += `${reactnativeultimatelistviewp.length / 2}`;
         break;
      }
      if (nalyticsm.includes(`${reactnativeultimatelistviewp.length}`)) {
         nalyticsm += `${mimo3.size & 3}`;
      }
      backwardH /= Math.max(parseFloat(`${parseInt(`${iconediti}`)}`), 1);
   if (2.23 <= (backwardH - 3.68) && 3.68 <= backwardH) {
       let twitter0 = String.fromCharCode(107,95,53,53,95,114,97,98,98,105,116,0);
       let nalytics4 = 5.0;
       let lessH = 3.0;
         lessH *= parseInt(`${nalytics4}`);
      if ((lessH * 5.55) < 2.1 && 5.55 < (lessH * nalytics4)) {
         nalytics4 -= parseInt(`${nalytics4}`) & 1;
      }
          let predictionactiven = 5.0;
          let otherF: Array<any> = [831, 233, 846];
          let frame_k4B = String.fromCharCode(104,95,57,57,95,114,103,98,116,111,121,118,0);
         lessH /= Math.max(4, 2);
         predictionactiven -= frame_k4B.length ^ 3;
         otherF.push((String.fromCharCode(90,0) == frame_k4B ? frame_k4B.length : otherF.length));
          let gestureo: Array<any> = [880, 940];
          let overlayw = String.fromCharCode(110,95,54,50,95,119,101,105,103,104,116,105,110,103,0);
         nalytics4 -= parseInt(`${nalytics4}`);
         gestureo.push(overlayw.length * gestureo.length);
         overlayw = `${gestureo.length * 2}`;
      let matchactivea = 7842865.0 >= nalytics4;
      do {
         nalytics4 /= Math.max(2 << (Math.min(2, twitter0.length)), 3);
         if (matchactivea) {
            break;
         }
      } while (matchactivea && ((2 - twitter0.length) <= 4));
      while ((1 << (Math.min(4, twitter0.length))) >= 1) {
          let animationsG: Map<any, any> = new Map([[String.fromCharCode(97,95,53,54,95,116,104,101,110,0),308], [String.fromCharCode(115,108,105,112,112,97,103,101,95,111,95,50,55,0),457]]);
          let middlewareo: Map<any, any> = new Map([[String.fromCharCode(108,95,57,95,100,101,99,111,109,112,114,101,115,115,0),String.fromCharCode(118,95,53,48,95,116,98,108,101,110,100,0)], [String.fromCharCode(112,95,52,54,95,118,97,114,121,105,110,103,0),String.fromCharCode(113,117,97,100,95,102,95,56,54,0)]]);
          let libreactb = true;
         twitter0 += `${3 * animationsG.size}`;
         animationsG = new Map([[`${middlewareo.size}`, ((libreactb ? 4 : 1) & middlewareo.size)]]);
         libreactb = libreactb || middlewareo.size == 25;
         break;
      }
         twitter0 += `${parseInt(`${nalytics4}`)}`;
      if (twitter0.length <= lessH) {
         lessH /= Math.max(parseInt(`${nalytics4}`), 5);
      }
          let screen4 = String.fromCharCode(117,116,118,105,100,101,111,95,119,95,53,0);
          let selectedS = String.fromCharCode(117,95,55,49,95,101,110,99,111,100,105,110,103,0);
         nalytics4 -= (twitter0 == String.fromCharCode(114,0) ? screen4.length : twitter0.length);
         screen4 += `${selectedS.length << (Math.min(Math.abs(2), 1))}`;
         selectedS = `${selectedS.length << (Math.min(selectedS.length, 3))}`;
      mbjscommonT = 79.45 >= encryptm || lessH >= 79.45;
   }
   let nativer = iconwechatK.length <= 9660419;
   do {
      iconwechatK = `${iconwechatK.length}`;
      if (nativer) {
         break;
      }
   } while ((encryptm == 3.15) && nativer);

    historyRef?.current?.scrollToIndex({
      index: 0,
      animated: false,
    });
  };

  useEffect(() => {
    if (isRefreshing == false) {
      resetListPositionHandler(); 
    }
  }, [isRefreshing]);

  return (
    <FlatList
      ref={historyRef}
      data={vodList}
      horizontal
      showsHorizontalScrollIndicator={false}
      keyExtractor={(item) => item.vod_id.toString()}
      renderItem={({item, index}: wwCasting) => {
        return (
          <VodCard
            showPlayIcon={true}
            vodImageStyle={vodStyle}
            shadowBottom={true}
            vod_name={item.vod_name}
            vod_pic={item.vod_pic}
            showInfo={
              showInfo === 'none'
                ? ''
                : `观看至 ${new Date(1000 * item.timeWatched)
                    .toISOString()
                    .substr(11, 8)}`
            }
            onPress={() => {
              dispatch(playVod(item));
              navigation.navigate('播放', {vod_id: item.vod_id});
            }}
            index={index}
          />
        );
      }}
    />
  );
}

const styles = StyleSheet.create({});
