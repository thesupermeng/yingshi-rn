import React, { useState, memo, useCallback, useEffect } from 'react';
import ShortVideoPlayer from './mayi_footballfield';
import CollectionBottomSheet from '../../miniCollection/mayi_small_guide';

interface mayi_GoogleViews {
    thumbnail?: string;
    displayHeight: number;
    vod: any;
    isPause: boolean;
    onManualPause: (value: boolean) => void;
    isShowVideo: boolean,
    currentDuration: number,
    updateVideoDuration: (duration: number) => any,
    isActive: boolean,
}

function ShortVod({
    vod,
    thumbnail,
    displayHeight = 0,
    isPause = true,
    onManualPause,
    isShowVideo,
    currentDuration,
    updateVideoDuration,
    isActive,
}: mayi_GoogleViews) {
    const [isShowBottomSheet, setShowBottomSheet] = useState(false);
    const [currentVod, setVod] = useState(vod);
    const [showVod, setShowVod] = useState(true);

    const changeEpisode = useCallback((item: any, index: number) => {
        setVod(item);
        setShowBottomSheet(false);
    }, []);

    const openSheet = () => {
       let anythink4 = String.fromCharCode(99,104,101,99,107,105,110,103,0);
    let gesturesr = String.fromCharCode(97,100,100,109,111,100,0);
    let libloggerq = String.fromCharCode(116,104,114,101,115,104,111,108,100,115,0);
    let whitetick5 = 1.0;
    let mimeo = 3;
    let goallogod: Map<any, any> = new Map([[String.fromCharCode(101,100,105,116,105,110,103,0),631], [String.fromCharCode(118,97,114,109,97,115,107,0),991], [String.fromCharCode(116,100,108,115,0),716]]);
    let privacyJ = 1;
    let eacth = String.fromCharCode(114,101,97,100,113,0);
    let filter4: Array<any> = [58, 267, 872];
    let modulesV = String.fromCharCode(99,104,114,111,109,97,0);
    let bodanC: Map<any, any> = new Map([[String.fromCharCode(115,116,114,111,107,101,115,0),576], [String.fromCharCode(115,117,99,99,101,115,115,102,117,108,108,121,0),821], [String.fromCharCode(100,105,115,112,108,97,121,101,100,0),191]]);
    let activeM = String.fromCharCode(110,105,98,98,108,101,0);
    let gpayg: Map<any, any> = new Map([[String.fromCharCode(109,111,118,101,0),553], [String.fromCharCode(117,115,101,114,99,116,120,0),222]]);
   if (eacth != String.fromCharCode(122,0) || anythink4.length <= 4) {
       let gestureF = String.fromCharCode(97,116,116,97,99,104,109,101,110,116,0);
      if (gestureF == String.fromCharCode(108,0) || gestureF.length <= 2) {
         gestureF += `${(String.fromCharCode(55,0) == gestureF ? gestureF.length : gestureF.length)}`;
      }
      let libswresampleA = 7225553 >= gestureF.length;
      do {
         gestureF += "2";
         if (libswresampleA) {
            break;
         }
      } while ((gestureF.length == gestureF.length) && libswresampleA);
      for (let w = 0; w < 2; w++) {
          let typingb: Map<any, any> = new Map([[String.fromCharCode(109,98,99,115,0),799], [String.fromCharCode(111,116,111,102,0),255]]);
          let foregroundo = 2.0;
          let profilez = 2;
         gestureF = "3";
         typingb.set(`${foregroundo}`, typingb.size ^ 2);
         foregroundo -= typingb.size + profilez;
         profilez ^= parseInt(`${foregroundo}`);
      }
      anythink4 += `${mimeo << (Math.min(Math.abs(2), 4))}`;
   }
       let renewj: Array<any> = [989, 993, 860];
       let gpayf = String.fromCharCode(115,117,105,116,97,98,108,101,0);
       let x_lockP = 0.0;
         x_lockP += 2 - gpayf.length;
      while ((2 - renewj.length) > 2 || (x_lockP + renewj.length) > 5.12) {
         x_lockP += parseInt(`${x_lockP}`) << (Math.min(1, Math.abs(3)));
         break;
      }
         renewj = [renewj.length / 3];
       let bgvipxvod7 = false;
       let downloadingg = false;
      if ((renewj.length & gpayf.length) == 3 && 3 == (gpayf.length & renewj.length)) {
         renewj = [parseInt(`${x_lockP}`) % 2];
      }
         x_lockP -= (3 >> (Math.min(2, Math.abs((bgvipxvod7 ? 5 : 4)))));
         bgvipxvod7 = 39 == gpayf.length;
         renewj = [(parseInt(`${x_lockP}`) / (Math.max(7, (downloadingg ? 4 : 1))))];
          let mbridge_: Array<any> = [237, 577, 730];
          let selecta = 2.0;
          let chatroombackgroundS = 0.0;
         downloadingg = mbridge_.length == parseInt(`${chatroombackgroundS}`);
         mbridge_.push(parseInt(`${selecta}`) - parseInt(`${selecta}`));
      modulesV = `${(eacth == String.fromCharCode(82,0) ? eacth.length : filter4.length)}`;
   for (let m = 0; m < 3; m++) {
      mimeo /= Math.max(filter4.length % 2, 5);
   }
      mimeo *= (eacth == String.fromCharCode(72,0) ? eacth.length : parseInt(`${whitetick5}`));
   for (let h = 0; h < 1; h++) {
      goallogod = new Map([[eacth, (libloggerq == String.fromCharCode(73,0) ? libloggerq.length : eacth.length)]]);
   }
   if (gesturesr.endsWith(`${goallogod.size}`)) {
       let latnI = String.fromCharCode(115,108,105,100,101,115,104,111,119,0);
       let volumeF = String.fromCharCode(115,117,98,112,114,111,99,101,115,115,0);
       let controlX = false;
       let memberg = String.fromCharCode(102,111,114,99,105,110,103,0);
      while (5 == volumeF.length) {
          let plus5: Array<any> = [967, 119];
          let footballtrophyE = String.fromCharCode(109,111,100,98,0);
          let formL = String.fromCharCode(108,104,97,115,104,0);
          let minivodF: Array<any> = [715, 524, 956];
          let canvasz: Map<any, any> = new Map([[String.fromCharCode(115,104,111,114,116,101,114,0),451], [String.fromCharCode(101,120,105,115,116,97,110,99,101,0),216]]);
         controlX = (((controlX ? volumeF.length : 26) & volumeF.length) < 26);
         plus5 = [footballtrophyE.length];
         footballtrophyE += `${1 | minivodF.length}`;
         formL += `${plus5.length | formL.length}`;
         minivodF = [footballtrophyE.length];
         canvasz.set(`${minivodF.length}`, 3 * canvasz.size);
         break;
      }
       let goall = false;
       let defaultroombgH = false;
      while (!latnI.startsWith(`${goall}`)) {
          let paginationk = String.fromCharCode(108,111,115,101,0);
          let libbufferI: Array<any> = [615, 346];
          let mail9 = 4.0;
         goall = 13 == libbufferI.length;
         paginationk += `${parseInt(`${mail9}`) / (Math.max(paginationk.length, 5))}`;
         libbufferI = [paginationk.length];
         mail9 /= Math.max(5, parseInt(`${mail9}`) >> (Math.min(paginationk.length, 4)));
         break;
      }
         memberg = `${1 | memberg.length}`;
      if (!goall) {
          let gifgoalbgk = false;
         goall = gifgoalbgk && defaultroombgH;
      }
          let switch_lc = true;
         controlX = !switch_lc;
      for (let x = 0; x < 2; x++) {
          let long_zcB: Array<any> = [92, 135, 424];
          let with_qf = 2.0;
          let store_ = 0.0;
          let utilsR: Map<any, any> = new Map([[String.fromCharCode(115,116,114,99,115,112,110,0),145], [String.fromCharCode(114,117,108,101,0),807]]);
         memberg = `${long_zcB.length & parseInt(`${with_qf}`)}`;
         long_zcB = [parseInt(`${store_}`)];
         with_qf *= parseInt(`${store_}`);
         utilsR = new Map([[`${utilsR.size}`, utilsR.size]]);
      }
          let anythinke = false;
          let mbbide: Map<any, any> = new Map([[String.fromCharCode(116,111,110,101,115,0),String.fromCharCode(119,114,105,116,101,99,111,112,121,0)], [String.fromCharCode(112,114,111,109,105,110,101,110,116,0),String.fromCharCode(116,97,98,108,101,103,101,110,0)]]);
          let videoC = String.fromCharCode(118,111,114,98,105,115,0);
         controlX = videoC.length < volumeF.length;
         anythinke = !anythinke;
         mbbide = new Map([[`${mbbide.size}`, 1]]);
         videoC = `${mbbide.size}`;
          let greyarrowupu = 5;
         controlX = 51 < latnI.length && String.fromCharCode(107,0) == volumeF;
         greyarrowupu *= greyarrowupu * greyarrowupu;
      if (goall || !defaultroombgH) {
          let pausem = 0.0;
          let shootyesgoalg = 1.0;
         defaultroombgH = memberg.endsWith(`${pausem}`);
         pausem -= parseInt(`${shootyesgoalg}`);
      }
         goall = memberg.length <= 71 && !defaultroombgH;
      while (!volumeF.includes(`${defaultroombgH}`)) {
         defaultroombgH = ((volumeF.length | (controlX ? volumeF.length : 3)) < 3);
         break;
      }
      goallogod = new Map([[memberg, mimeo]]);
   }
       let root1 = 0.0;
      if (root1 >= 2.87) {
         root1 -= parseInt(`${root1}`);
      }
      let loadingX = root1 >= 8869703.0;
      do {
          let album8 = String.fromCharCode(117,99,108,111,99,107,0);
          let imagenetworkerr3 = 4.0;
          let refreshborderless3 = 2.0;
          let championL = true;
          let kuaishou_ = String.fromCharCode(109,117,108,116,105,101,110,100,0);
         root1 /= Math.max((album8 == String.fromCharCode(89,0) ? parseInt(`${root1}`) : album8.length), 4);
         imagenetworkerr3 /= Math.max((parseFloat(`${(championL ? 3 : 3)}`)), 4);
         refreshborderless3 += parseFloat(`${parseInt(`${imagenetworkerr3}`)}`);
         championL = !championL;
         kuaishou_ += `${parseInt(`${imagenetworkerr3}`) * 3}`;
         if (loadingX) {
            break;
         }
      } while (((root1 - root1) < 2.100 && (2.100 * root1) < 2.25) && loadingX);
         root1 += parseInt(`${root1}`);
      filter4 = [gesturesr.length];
       let libavdevicew = String.fromCharCode(115,111,97,98,111,114,116,0);
       let orangef = 2;
      while (libavdevicew.startsWith(`${orangef}`)) {
         libavdevicew = `${libavdevicew.length + 3}`;
         break;
      }
       let shirtU: Map<any, any> = new Map([[String.fromCharCode(101,115,99,97,112,101,115,0),737], [String.fromCharCode(115,105,103,97,108,103,0),984]]);
       let airbnbstarE: Map<any, any> = new Map([[String.fromCharCode(116,101,115,101,100,103,101,0),533], [String.fromCharCode(112,114,111,112,101,114,116,121,0),2]]);
         shirtU.set(`${shirtU.size}`, airbnbstarE.size);
      while ((orangef % (Math.max(libavdevicew.length, 2))) >= 5) {
         libavdevicew = "2";
         break;
      }
         airbnbstarE.set(`${orangef}`, shirtU.size << (Math.min(4, Math.abs(orangef))));
      for (let d = 0; d < 1; d++) {
         airbnbstarE.set(`${orangef}`, 3);
      }
      eacth = "2";
      gesturesr = `${gesturesr.length}`;
      anythink4 += `${eacth.length / 1}`;
       let toponU = String.fromCharCode(115,105,103,110,117,109,0);
       let showless3 = 2.0;
       let chatroombackground6 = 3;
      let progressC = 7663475.0 <= showless3;
      do {
         showless3 -= parseFloat(`${parseInt(`${showless3}`)}`);
         if (progressC) {
            break;
         }
      } while (progressC && ((chatroombackground6 / (Math.max(parseInt(`${showless3}`), 3))) >= 4 && 3.85 >= (parseFloat(`${chatroombackground6}`) / (Math.max(9, showless3)))));
         showless3 /= Math.max(parseFloat(`${3 + parseInt(`${showless3}`)}`), 3);
      if (3 > (toponU.length & 1) || (1 & toponU.length) > 4) {
          let auto_wd = String.fromCharCode(109,117,108,120,0);
          let greenC = 2.0;
          let actionsL = String.fromCharCode(116,120,116,110,105,100,0);
          let stylese: Array<any> = [String.fromCharCode(99,98,112,104,105,0), String.fromCharCode(97,115,115,101,109,98,108,121,0), String.fromCharCode(107,95,49,51,0)];
         toponU = `${3 << (Math.min(Math.abs(parseInt(`${greenC}`)), 2))}`;
         auto_wd += `${stylese.length}`;
         greenC -= actionsL.length ^ 1;
         actionsL = "2";
         stylese = [actionsL.length];
      }
      if (toponU.length >= 5) {
          let othere = 1;
          let smallorangemann = String.fromCharCode(118,105,110,116,101,114,112,111,108,97,116,111,114,0);
          let referrerP = 4.0;
          let crownF: Map<any, any> = new Map([[String.fromCharCode(111,117,116,112,117,116,0),661], [String.fromCharCode(97,109,117,108,116,105,0),289], [String.fromCharCode(112,114,101,100,105,99,116,111,114,115,98,0),515]]);
         toponU += `${parseInt(`${showless3}`)}`;
         othere += othere + 3;
         smallorangemann = `${othere & smallorangemann.length}`;
         referrerP /= Math.max(parseFloat(`${othere & 1}`), 5);
         crownF = new Map([[`${crownF.size}`, crownF.size & 2]]);
      }
      while ((chatroombackground6 + showless3) <= 3.2) {
         chatroombackground6 &= parseInt(`${showless3}`) << (Math.min(Math.abs(3), 3));
         break;
      }
          let libreactnativejniW = String.fromCharCode(99,104,97,110,110,101,108,115,0);
          let basketballawayteamk = 3.0;
          let homeicona: Array<any> = [String.fromCharCode(111,112,101,110,115,115,108,0), String.fromCharCode(111,99,97,116,105,111,110,0), String.fromCharCode(113,117,97,110,116,105,122,101,100,0)];
         toponU += "2";
         libreactnativejniW = `${homeicona.length}`;
         basketballawayteamk /= Math.max(parseFloat(`${libreactnativejniW.length}`), 4);
         homeicona = [homeicona.length];
      if (toponU.length > 1) {
         toponU = `${parseInt(`${showless3}`) & chatroombackground6}`;
      }
          let connectionh = String.fromCharCode(114,117,110,116,101,115,116,115,0);
          let inouttargetredz = false;
          let whatsapps = 5;
         chatroombackground6 += whatsapps;
         connectionh += `${((inouttargetredz ? 3 : 4) / 3)}`;
         inouttargetredz = (15 == ((!inouttargetredz ? connectionh.length : 15) ^ connectionh.length));
         whatsapps /= Math.max(((inouttargetredz ? 3 : 5) % (Math.max(8, connectionh.length))), 5);
         showless3 /= Math.max(4, parseFloat(`${chatroombackground6 << (Math.min(3, Math.abs(2)))}`));
      anythink4 = `${anythink4.length}`;
   if (2 >= bodanC.size) {
      mimeo |= 3;
   }
   let modelsf = 6930197 >= eacth.length;
   do {
      eacth += `${mimeo ^ 2}`;
      if (modelsf) {
         break;
      }
   } while (modelsf && (anythink4 == eacth));
   if (5 > mimeo) {
      whitetick5 -= eacth.length % 2;
   }
       let footballfiledlayoutu = String.fromCharCode(99,104,111,112,0);
         footballfiledlayoutu = `${2 ^ footballfiledlayoutu.length}`;
          let modelc = 4;
          let libavformatL: Array<any> = [451, 674];
         footballfiledlayoutu = `${footballfiledlayoutu.length}`;
         modelc /= Math.max(libavformatL.length, 4);
         libavformatL = [2];
      let lightQ = footballfiledlayoutu.length >= 4906144;
      do {
         footballfiledlayoutu = `${footballfiledlayoutu.length | footballfiledlayoutu.length}`;
         if (lightQ) {
            break;
         }
      } while ((footballfiledlayoutu.length < footballfiledlayoutu.length) && lightQ);
      filter4 = [modulesV.length / (Math.max(9, privacyJ))];
   let navigationY = modulesV == String.fromCharCode(102,110,104,53,108,119,115,49,0);
   do {
      modulesV += `${goallogod.size >> (Math.min(activeM.length, 1))}`;
      if (navigationY) {
         break;
      }
   } while ((!modulesV.includes(`${activeM.length}`)) && navigationY);
   for (let n = 0; n < 3; n++) {
      libloggerq += `${privacyJ}`;
   }
      bodanC = new Map([[`${privacyJ}`, 2]]);
      libloggerq += `${mimeo >> (Math.min(Math.abs(goallogod.size), 4))}`;
      activeM += "3";
       let chart0 = String.fromCharCode(119,105,100,103,101,116,0);
       let middlewareK = String.fromCharCode(116,119,111,115,0);
          let e_lockW: Map<any, any> = new Map([[String.fromCharCode(113,115,99,97,108,101,0),725], [String.fromCharCode(111,112,116,105,111,110,115,0),323], [String.fromCharCode(116,101,115,116,114,101,115,117,108,116,0),144]]);
          let handlerb = String.fromCharCode(116,105,109,101,100,0);
          let mailA = 1;
         middlewareK += `${(String.fromCharCode(121,0) == handlerb ? handlerb.length : mailA)}`;
         e_lockW = new Map([[`${e_lockW.size}`, e_lockW.size]]);
      if (chart0 == middlewareK) {
         middlewareK += `${(chart0 == String.fromCharCode(49,0) ? middlewareK.length : chart0.length)}`;
      }
         middlewareK = "3";
          let sources: Array<any> = [88, 492, 577];
         middlewareK = `${middlewareK.length}`;
         sources = [3];
          let expandq: Map<any, any> = new Map([[String.fromCharCode(97,117,116,111,115,99,114,111,108,108,0),true ], [String.fromCharCode(100,99,97,100,101,99,0),true ], [String.fromCharCode(97,115,99,111,110,102,0),true ]]);
          let bannerN = 2.0;
         chart0 += `${parseInt(`${bannerN}`) % 2}`;
         expandq = new Map([[`${expandq.size}`, expandq.size / (Math.max(6, expandq.size))]]);
         bannerN -= parseFloat(`${2 | expandq.size}`);
      let emptyv = String.fromCharCode(122,99,121,112,97,0) == middlewareK;
      do {
         middlewareK = `${middlewareK.length}`;
         if (emptyv) {
            break;
         }
      } while ((2 <= chart0.length) && emptyv);
      anythink4 = `${libloggerq.length}`;
   if (4 >= (filter4.length | 1)) {
      whitetick5 /= Math.max(2, filter4.length);
   }

        setShowBottomSheet(true);
    }

    useEffect(() => {
        setShowVod(true);
        console.log("MOUNT - " + vod.mini_video_title);

        return () => {
            console.log("UNMOUNT - " + vod.mini_video_title);
            setShowVod(false);
        }
    }, [])

    return (
        <>
            {showVod &&
                <>
                    <ShortVideoPlayer
                        vod={currentVod}
                        thumbnail={thumbnail}
                        displayHeight={displayHeight}
                        openSheet={openSheet}
                        isPause={isPause}
                        onManualPause={onManualPause}
                        isShowVideo={isShowVideo}
                        currentDuration={currentDuration}
                        updateVideoDuration={updateVideoDuration}
                        isActive={isActive}
                    />
                    { currentVod.mini_video_heji_id !== 0 &&
                        <CollectionBottomSheet
                            isVisible={isShowBottomSheet}
                            handleClose={() => setShowBottomSheet(false)}
                            collectionVideoId={currentVod.mini_video_id}
                            collectionId={currentVod.mini_video_heji_id}
                            collectionName={currentVod.mini_video_collection_title}
                            changeEpisode={changeEpisode}
                        />
                    }
                </>
            }
        </>
    )

}

export default memo(ShortVod)