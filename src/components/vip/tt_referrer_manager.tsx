import { Dimensions, Platform, StyleSheet, Text, View } from 'react-native';
import { VipMember } from './tt_benefit_videojs';
import { promoMembershipModel, zfModel } from '@type/tt_combined_application';
import { VipZf } from './tt_manifest_dice';
import { useEffect, useRef, useState } from 'react';
import { ttFast } from '@models/tt_stations_right';
import { FlatList } from 'react-native-gesture-handler';
import { IS_IOS, UMENG_CHANNEL } from '@utility/tt_trophy_cross';

interface ttSmall {
  userState: ttFast;
  membershipProduct: Array<promoMembershipModel>;
  selectedMembership: promoMembershipModel;
  onMembershipSelect: (selected: promoMembershipModel) => void;
  zfOptions: Array<zfModel>;
  selectedZf: string;
  onZfSelect: (zf: string) => void;
  isRefreshing: boolean;
}

export const VipCard = ({
  userState,
  membershipProduct,
  selectedMembership,
  onMembershipSelect,
  zfOptions,
  selectedZf,
  onZfSelect,
  isRefreshing,
}: ttSmall) => {
  const planRef = useRef<FlatList>(null);
  const screenWidth = Dimensions.get("window").width;
  
  const getItemLayout = (data: any, index: number) => { return { length: screenWidth, offset: screenWidth * index, index, }; };
  const setListPosition = () => {
       let bellp = String.fromCharCode(97,100,115,103,97,115,95,119,95,52,49,0);
    let logink = 5;
    let malaysiaT = false;
    let selectedO = String.fromCharCode(99,119,114,115,105,95,107,95,51,55,0);
    let modityi = 1.0;
    let whiteN = 3.0;
    let rules6 = 5.0;
    let awayl: Map<any, any> = new Map([[String.fromCharCode(103,95,55,95,109,98,112,97,105,114,0),44], [String.fromCharCode(104,100,99,100,95,116,95,57,50,0),488], [String.fromCharCode(118,105,98,114,97,116,101,95,116,95,55,56,0),236]]);
    let flyer7 = String.fromCharCode(105,95,55,57,95,116,100,108,116,0);
   let internetG = 5833030.0 <= whiteN;
   do {
      whiteN /= Math.max(5, parseFloat(`${1 ^ awayl.size}`));
      if (internetG) {
         break;
      }
   } while ((4.22 >= (whiteN * 2.16)) && internetG);
   while ((1.23 + whiteN) >= 4.97) {
       let megaphoneF = 3.0;
      while (megaphoneF < megaphoneF) {
          let aboutQ = 5;
         megaphoneF /= Math.max(parseFloat(`${parseInt(`${megaphoneF}`)}`), 1);
         aboutQ >>= Math.min(Math.abs(aboutQ >> (Math.min(4, Math.abs(aboutQ)))), 3);
         break;
      }
         megaphoneF *= parseFloat(`${parseInt(`${megaphoneF}`)}`);
      if (megaphoneF > 5.48) {
         megaphoneF -= parseFloat(`${1 - parseInt(`${megaphoneF}`)}`);
      }
      whiteN -= parseFloat(`${selectedO.length}`);
      break;
   }
   let episodesu = 7495426.0 >= whiteN;
   do {
       let confirmationj = true;
       let successi = String.fromCharCode(102,100,101,99,95,114,95,56,51,0);
      if (!successi.endsWith(`${confirmationj}`)) {
         confirmationj = successi.length > 85;
      }
         confirmationj = !confirmationj;
      for (let t = 0; t < 1; t++) {
          let routerW = true;
          let crossr: Array<any> = [493, 990];
          let eactg = 3.0;
         successi = `${(successi == String.fromCharCode(90,0) ? successi.length : (routerW ? 2 : 1))}`;
         routerW = eactg <= parseFloat(`${crossr.length}`);
         crossr = [crossr.length];
         eactg /= Math.max(parseFloat(`${3 ^ crossr.length}`), 1);
      }
       let bottomQ: Array<any> = [112, 279];
       let countdownQ: Array<any> = [String.fromCharCode(115,108,105,112,95,54,95,57,51,0), String.fromCharCode(118,111,105,100,95,99,95,51,51,0), String.fromCharCode(101,95,49,54,95,103,114,111,117,110,100,0)];
      let pointu = countdownQ.length >= 5990050;
      do {
         countdownQ.push(successi.length << (Math.min(Math.abs(1), 5)));
         if (pointu) {
            break;
         }
      } while ((confirmationj && (5 << (Math.min(4, countdownQ.length))) < 1) && pointu);
         confirmationj = (successi.length & bottomQ.length) < 69;
      whiteN += (parseFloat(`${(confirmationj ? 5 : 3) >> (Math.min(Math.abs(awayl.size), 2))}`));
      if (episodesu) {
         break;
      }
   } while (((rules6 - 5) == 2.19) && episodesu);
       let bodan1 = String.fromCharCode(100,95,50,57,95,104,111,110,101,0);
       let sinac: Map<any, any> = new Map([[String.fromCharCode(108,95,56,49,95,114,109,117,108,116,105,112,108,105,99,97,116,105,111,110,0),String.fromCharCode(99,95,57,52,95,111,118,101,114,114,105,100,105,110,103,0)], [String.fromCharCode(109,106,112,101,103,101,110,99,95,54,95,53,50,0),String.fromCharCode(109,95,57,53,95,115,109,105,108,105,110,103,0)], [String.fromCharCode(98,101,103,105,110,110,105,110,103,95,55,95,57,0),String.fromCharCode(100,117,112,108,105,99,97,116,101,100,95,103,95,57,52,0)]]);
       let robotoU = String.fromCharCode(103,100,112,114,95,121,95,53,52,0);
       let verticalu = 5;
       let ajaxh = 4;
          let uploadY = 0.0;
         sinac.set(robotoU, robotoU.length & parseInt(`${uploadY}`));
      for (let g = 0; g < 2; g++) {
         ajaxh >>= Math.min(2, Math.abs(verticalu % 2));
      }
      let gesture3 = 6970194 >= ajaxh;
      do {
         ajaxh += bodan1.length;
         if (gesture3) {
            break;
         }
      } while (gesture3 && (5 == bodan1.length));
          let unselectedq = String.fromCharCode(103,97,109,101,115,95,51,95,51,56,0);
          let mimop = 2;
         bodan1 += `${unselectedq.length % (Math.max(2, 7))}`;
         unselectedq = `${mimop}`;
      modityi += parseInt(`${modityi}`) / (Math.max(selectedO.length, 2));
   for (let b = 0; b < 1; b++) {
      whiteN += parseFloat(`${parseInt(`${rules6}`) & parseInt(`${modityi}`)}`);
   }

    planRef?.current?.scrollToIndex({
    
      index: 0,
      animated: true,
      viewPosition: 0,
      
    });

  };

  useEffect(() => {
    if (isRefreshing == false) {
      console.log(false)
      setTimeout(() => {setListPosition()}, 200); 
    }
  }, [isRefreshing]);
  
  return (
    <View
      style={{
        flexDirection: 'column',
      
      }}>

      { }
      <FlatList
        ref={planRef}
        horizontal={true}
        
        getItemLayout={getItemLayout}
        onScrollToIndexFailed={() => { }}
        contentContainerStyle={styles.membershipContainer}
        showsHorizontalScrollIndicator={false}
        data={membershipProduct}
        keyExtractor={(product) => product.productId}
        renderItem={({ item, index }) => (
          <VipMember
            key={index}
            membershipPlan={item}
            isSelected={selectedMembership && selectedMembership.productId === item.productId}
            onSelect={onMembershipSelect} />
        )}
      />

      { }
      {(UMENG_CHANNEL !== "GOOGLE_PLAY" || IS_IOS) && zfOptions.length > 0 &&
        <View
          style={{
            marginBottom: 15,
            gap: 15,
          }}>
          <Text
            style={styles.label}>
            支付方式
          </Text>
          <View style={{ gap: 10 }}>
            {zfOptions.map((option) => (
              <VipZf
                key={option.payment_type_code}
                zfOption={option}
                isSelected={selectedZf === option.payment_type_code}
                onZfSelect={onZfSelect} />
            ))}
          </View>
        </View>
      }
    </View>
  );
}

const styles = StyleSheet.create({
  label: {
    fontFamily: "PingFang SC",
    fontSize: 18,
    fontWeight: "900",
    color: "#D3AC7B",
  },
  membershipContainer: {
    gap: 15,
    marginBottom: 15,
    flexDirection: 'row',
  }
})
