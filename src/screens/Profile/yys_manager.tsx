import React, { useState } from "react";
import {
  View,
  TouchableOpacity,
  Text,
  StyleSheet,
  ScrollView,
} from "react-native";
import ScreenContainer from "../../components/container/yys_executor_expand";
import { RootStackScreenProps } from "@type/yys_settings";
import { useTheme } from "@react-navigation/native";
import { useAppDispatch, useAppSelector } from "@hooks/yys_frame";
import { yys_MintegralLibavdevice } from "@redux/yys_sport_shrink";

import TitleWithBackButtonHeader from "../../components/header/yys_anner_header";
import {
  yys_CountdownSubmit,
  yys_BorderlessLibruntimeexecutor,
} from "@redux/reducers/yys_full";
import { removeVodsFromHistory, playVod } from "@redux/actions/yys_player_style";
import VodHistoryCard from "../../components/vod/yys_upgrade_graphics";
import CheckBoxSelected from "@static/images/progressChina.svg";
import CheckBoxUnselected from "@static/images/targetFeedback.svg";
import { yys_Bing } from "@type/yys_libzeus";
import { Button } from "@rneui/themed";
import ConfirmationModal from "../../components/modal/yys_shrink_reactnativejs";
import EmptyList from "../../components/common/yys_goal_utils";
import { disableAdultMode, enableAdultMode } from "@redux/actions/yys_runtimescheduler";

type yys_Mbsplash = {
  item: yys_CountdownSubmit;
};

export default ({ navigation }: RootStackScreenProps<"播放历史">) => {
  const { colors, textVariants, icons, spacing } = useTheme();
  const dispatch = useAppDispatch();
  const vodReducer: yys_BorderlessLibruntimeexecutor = useAppSelector(
    ({ vodReducer }: yys_MintegralLibavdevice) => vodReducer
  );
  const history = vodReducer.history;
  const [isEditing, setIsEditing] = useState(false);
  const [removeHistory, setRemoveHistory] = useState<Array<yys_Bing>>([]);
  const [isDialogOpen, setIsDialogOpen] = useState(false);
  const textStyles = isEditing
    ? [styles.text, textVariants.body, { marginLeft: 30 }]
    : [styles.text, textVariants.body];
  const toggleOverlay = () => {
       let save4 = String.fromCharCode(116,105,114,101,100,95,108,95,57,56,0);
    let zhengpianm: Array<any> = [402, 69, 82];
    let roundf = String.fromCharCode(105,95,56,51,0);
    let readd = 0.0;
    let feedbackC = 2;
    let l_imageg = 5;
    let libsgcoreu = 2.0;
    let refreshS: Array<any> = [600, 943, 878];
    let componentK = 5.0;
    let thailand4 = 1.0;
    let switch_fJ = String.fromCharCode(104,97,110,100,101,114,95,110,95,57,54,0);
    let valuesd = String.fromCharCode(102,114,97,109,101,115,95,103,95,55,48,0);
   if (5.95 == (thailand4 - 3.26)) {
      feedbackC *= zhengpianm.length - 3;
   }
   let navigationP = 7975455 >= feedbackC;
   do {
       let submit5 = 4;
       let bridgeW = String.fromCharCode(112,95,53,51,95,114,101,99,111,110,0);
       let lineE = 2;
       let untickF = 2;
      if ((1 ^ untickF) > 5) {
         submit5 += lineE / (Math.max(8, untickF));
      }
      while (2 < (untickF << (Math.min(Math.abs(lineE), 5)))) {
         lineE %= Math.max(2, untickF / 1);
         break;
      }
         bridgeW += `${bridgeW.length / 3}`;
      let roomP = submit5 >= 6746563;
      do {
          let link_ = true;
          let mbbidL: Array<any> = [375, 849];
          let modulet: Map<any, any> = new Map([[String.fromCharCode(99,108,97,112,95,112,95,57,51,0),380], [String.fromCharCode(110,111,114,109,97,108,105,122,101,114,95,104,95,52,55,0),377], [String.fromCharCode(99,111,110,102,101,116,116,105,95,114,95,49,56,0),16]]);
         submit5 *= 2;
         link_ = (mbbidL.length << (Math.min(Math.abs(modulet.size), 3))) <= 58;
         mbbidL = [2];
         modulet = new Map([[`${modulet.size}`, modulet.size]]);
         if (roomP) {
            break;
         }
      } while (((2 + bridgeW.length) <= 4 && 4 <= (2 + bridgeW.length)) && roomP);
      if (1 < (1 + bridgeW.length) || (untickF + 1) < 2) {
         bridgeW += `${lineE}`;
      }
      feedbackC |= 2 * switch_fJ.length;
      if (navigationP) {
         break;
      }
   } while (navigationP && (2 < (switch_fJ.length / 3)));
      feedbackC <<= Math.min(Math.abs(switch_fJ.length - 3), 4);
       let componentb: Array<any> = [51, 454];
       let anytimeK = String.fromCharCode(118,95,52,52,95,100,97,115,104,101,115,0);
         anytimeK = `${(String.fromCharCode(104,0) == anytimeK ? componentb.length : anytimeK.length)}`;
      for (let g = 0; g < 2; g++) {
          let mbjscommon2 = 0;
          let star4 = 0;
          let orientationH = 5;
          let macauO = 0.0;
          let untickT = 4.0;
         anytimeK += "2";
         mbjscommon2 &= 1 << (Math.min(Math.abs(parseInt(`${untickT}`)), 5));
         star4 <<= Math.min(Math.abs(3), 1);
         orientationH <<= Math.min(Math.abs(3 | mbjscommon2), 3);
         macauO -= 3 * parseInt(`${untickT}`);
      }
      refreshS = [parseInt(`${readd}`)];
      refreshS = [parseInt(`${readd}`)];
      roundf = `${2 + switch_fJ.length}`;
   if (1 == (zhengpianm.length % (Math.max(save4.length, 9))) || 1 == (zhengpianm.length % (Math.max(save4.length, 9)))) {
      save4 = "1";
   }
   let final_8yC = feedbackC >= 6677487;
   do {
      feedbackC /= Math.max(3 & feedbackC, 5);
      if (final_8yC) {
         break;
      }
   } while ((zhengpianm.includes(feedbackC)) && final_8yC);
      zhengpianm = [l_imageg];
      switch_fJ = `${feedbackC / (Math.max(parseInt(`${libsgcoreu}`), 5))}`;
   while (readd > 5.25) {
       let neonw = String.fromCharCode(104,95,56,57,95,116,114,97,110,115,105,101,110,116,0);
       let teamd: Map<any, any> = new Map([[String.fromCharCode(102,95,51,49,95,98,110,98,105,110,0),788], [String.fromCharCode(114,101,118,101,97,108,101,100,95,105,95,56,54,0),317], [String.fromCharCode(115,112,97,99,105,110,103,115,95,57,95,51,49,0),933]]);
       let j_lockf = false;
       let dialogb = false;
          let templateprocessorr = String.fromCharCode(107,95,53,51,95,120,115,117,98,0);
          let directr: Map<any, any> = new Map([[String.fromCharCode(102,108,105,112,95,115,95,53,48,0),true ], [String.fromCharCode(114,97,116,101,95,52,95,56,57,0),false ]]);
          let submitm = false;
         j_lockf = !submitm;
         templateprocessorr += `${1 / (Math.max(6, templateprocessorr.length))}`;
         directr = new Map([[`${directr.size}`, 1 | templateprocessorr.length]]);
         j_lockf = String.fromCharCode(85,0) == neonw;
      while (dialogb) {
          let downQ = 4.0;
          let uimanagerc = String.fromCharCode(101,95,57,55,95,116,101,115,116,105,109,103,105,110,116,0);
          let y_lock0 = 4.0;
          let libreactperfloggerjniM: Array<any> = [249, 640];
         j_lockf = (j_lockf ? !dialogb : !j_lockf);
         downQ /= Math.max(parseFloat(`${1}`), 1);
         uimanagerc += `${parseInt(`${downQ}`)}`;
         y_lock0 -= parseInt(`${downQ}`) % (Math.max(uimanagerc.length, 5));
         libreactperfloggerjniM = [3 + libreactperfloggerjniM.length];
         break;
      }
          let type_1L: Array<any> = [402, 699];
          let clockP = String.fromCharCode(106,95,49,48,48,95,112,114,101,116,116,121,0);
         teamd.set(clockP, 2);
         type_1L.push(type_1L.length);
         clockP = `${1 - type_1L.length}`;
          let formd = String.fromCharCode(111,118,101,114,115,99,114,111,108,108,95,119,95,54,0);
         dialogb = teamd.size > 40;
         formd += "1";
      readd += parseFloat(`${2}`);
      break;
   }
       let build7: Map<any, any> = new Map([[String.fromCharCode(99,95,57,54,95,106,97,99,111,98,105,97,110,0),374], [String.fromCharCode(100,95,53,53,95,109,97,114,107,100,111,119,110,0),984], [String.fromCharCode(109,111,114,101,95,118,95,57,53,0),441]]);
       let libfbi: Map<any, any> = new Map([[String.fromCharCode(109,101,109,99,112,121,95,119,95,53,48,0),499], [String.fromCharCode(100,101,108,101,103,97,116,105,111,110,95,117,95,56,57,0),254]]);
       let componentc = 1.0;
         libfbi = new Map([[`${libfbi.size}`, parseInt(`${componentc}`)]]);
         componentc -= libfbi.size % (Math.max(7, build7.size));
      for (let v = 0; v < 2; v++) {
         libfbi.set(`${build7.size}`, build7.size);
      }
       let libreanimatedT = String.fromCharCode(115,101,116,116,105,116,108,101,95,104,95,49,49,0);
       let leakchecker0 = String.fromCharCode(110,105,98,95,103,95,52,50,0);
       let sound2 = true;
       let holder1 = false;
          let bannerX = false;
         holder1 = 90.47 > componentc;
         bannerX = (bannerX ? bannerX : bannerX);
      let popup7 = sound2 ? !sound2 : sound2;
      do {
         sound2 = !libreanimatedT.includes(`${componentc}`);
         if (popup7) {
            break;
         }
      } while ((!sound2) && popup7);
          let libtan6 = 0.0;
          let heartq = 3.0;
          let verticaly = false;
         componentc /= Math.max(5, ((holder1 ? 4 : 2)));
         libtan6 /= Math.max(parseInt(`${heartq}`), 3);
         heartq /= Math.max(5, parseInt(`${libtan6}`));
         verticaly = heartq <= 40.12;
       let descY = String.fromCharCode(122,95,54,52,95,113,105,110,116,102,108,111,97,116,0);
      feedbackC |= build7.size;
   if ((refreshS.length - save4.length) >= 2 || 2 >= (save4.length - refreshS.length)) {
      refreshS.push(l_imageg * 2);
   }
   let screenu = 6036208 <= roundf.length;
   do {
       let langm = 1.0;
          let changeO = String.fromCharCode(122,95,49,50,95,105,110,100,101,120,101,115,0);
         langm /= Math.max(5, (parseFloat(`${String.fromCharCode(48,0) == changeO ? parseInt(`${langm}`) : changeO.length}`)));
      for (let n = 0; n < 1; n++) {
         langm += parseFloat(`${parseInt(`${langm}`) % (Math.max(parseInt(`${langm}`), 4))}`);
      }
         langm += parseFloat(`${parseInt(`${langm}`) % 3}`);
      roundf = `${parseInt(`${componentK}`) / 1}`;
      if (screenu) {
         break;
      }
   } while ((switch_fJ != roundf) && screenu);
   if (1.12 < (readd - thailand4) && (1.12 - readd) < 4.18) {
      readd -= parseFloat(`${1 >> (Math.min(1, roundf.length))}`);
   }
      readd += parseFloat(`${1}`);
   let libjsinspectori = zhengpianm.length <= 5853623;
   do {
       let stationc: Array<any> = [214, 317, 524];
       let selll: Array<any> = [297, 798, 934];
       let modityr: Array<any> = [892, 643, 110];
       let mbbannerJ = String.fromCharCode(104,95,53,52,95,99,111,99,111,97,0);
          let alertY = 0.0;
          let sansG = 4.0;
         modityr.push(parseInt(`${sansG}`) << (Math.min(3, Math.abs(2))));
         alertY += parseFloat(`${parseInt(`${alertY}`)}`);
         sansG -= 1 * parseInt(`${alertY}`);
      while ((5 - selll.length) > 1 && (selll.length - stationc.length) > 5) {
         stationc = [3];
         break;
      }
         stationc = [modityr.length ^ 2];
      if (5 >= (stationc.length | mbbannerJ.length) || (5 | mbbannerJ.length) >= 1) {
         mbbannerJ += `${(String.fromCharCode(88,0) == mbbannerJ ? mbbannerJ.length : modityr.length)}`;
      }
         selll = [2];
         stationc.push(selll.length | 1);
      let proxyS = selll.length >= 9376643;
      do {
         selll.push(selll.length << (Math.min(Math.abs(3), 3)));
         if (proxyS) {
            break;
         }
      } while ((selll.length <= 5) && proxyS);
          let nativemoduleC = String.fromCharCode(109,95,50,54,95,110,97,118,105,103,97,116,105,111,110,98,97,114,0);
          let countdown1 = false;
         stationc.push((nativemoduleC == String.fromCharCode(119,0) ? modityr.length : nativemoduleC.length));
         countdown1 = (countdown1 ? countdown1 : countdown1);
      while (3 > (selll.length << (Math.min(Math.abs(1), 5))) && (1 << (Math.min(2, selll.length))) > 4) {
         stationc.push(3 + modityr.length);
         break;
      }
         modityr = [2];
          let sortS: Array<any> = [198, 91, 396];
          let smallK = 3.0;
          let layoutn = 3;
         modityr.push(3 ^ sortS.length);
         sortS = [3 | parseInt(`${smallK}`)];
         smallK += parseFloat(`${parseInt(`${smallK}`) | 1}`);
         layoutn += parseInt(`${smallK}`);
         selll.push(stationc.length * 1);
      zhengpianm = [stationc.length];
      if (libjsinspectori) {
         break;
      }
   } while ((zhengpianm.length == 3) && libjsinspectori);
      feedbackC += refreshS.length;
   if (componentK <= 5.48) {
       let weiboo = String.fromCharCode(97,118,101,114,97,103,101,115,95,57,95,55,55,0);
       let spec2 = 1;
          let dycreatorV = 1.0;
         spec2 &= 3;
         dycreatorV += 1;
      if ((4 ^ weiboo.length) < 1 && (spec2 ^ weiboo.length) < 4) {
         weiboo += `${(String.fromCharCode(112,0) == weiboo ? weiboo.length : spec2)}`;
      }
      while (4 > spec2) {
         weiboo += "1 + spec2";
         break;
      }
      for (let z = 0; z < 1; z++) {
         weiboo = `${spec2 % (Math.max(weiboo.length, 3))}`;
      }
         spec2 /= Math.max(2, weiboo.length);
      for (let p = 0; p < 3; p++) {
         spec2 ^= spec2;
      }
      readd *= parseFloat(`${2}`);
   }
       let leaguev = 4;
       let stard = 1.0;
       let areas = 1.0;
         leaguev >>= Math.min(Math.abs(2), 5);
      if (1 >= (3 - leaguev)) {
         leaguev |= 2 & parseInt(`${stard}`);
      }
         stard *= parseFloat(`${2 ^ parseInt(`${stard}`)}`);
      if (3 < (2 + leaguev) || (leaguev - parseInt(`${stard}`)) < 2) {
          let usernameb: Map<any, any> = new Map([[String.fromCharCode(105,108,108,117,109,105,110,97,116,105,111,110,95,121,95,52,48,0),776], [String.fromCharCode(102,95,57,57,95,112,108,97,110,97,114,116,111,121,117,121,0),243]]);
          let iinit_3ae: Map<any, any> = new Map([[String.fromCharCode(112,114,111,99,101,115,115,111,114,115,95,109,95,54,55,0),true ], [String.fromCharCode(115,97,118,101,114,95,104,95,52,49,0),false ], [String.fromCharCode(110,95,52,53,95,97,118,117,105,0),true ]]);
          let downloadr: Array<any> = [903, 206, 690];
          let libcxxcomponentsk = 1.0;
         stard += parseFloat(`${iinit_3ae.size}`);
         usernameb = new Map([[`${usernameb.size}`, usernameb.size]]);
         iinit_3ae = new Map([[`${downloadr.length}`, parseInt(`${libcxxcomponentsk}`)]]);
         downloadr.push(usernameb.size | 2);
         libcxxcomponentsk *= parseFloat(`${downloadr.length + parseInt(`${libcxxcomponentsk}`)}`);
      }
      for (let d = 0; d < 2; d++) {
         areas += parseFloat(`${parseInt(`${stard}`)}`);
      }
      while ((areas - stard) <= 2.83 || 1.32 <= (2.83 - areas)) {
         areas += parseFloat(`${3}`);
         break;
      }
      if (2.18 >= (areas + leaguev)) {
          let sportx = true;
          let promotionS = String.fromCharCode(117,95,57,50,95,115,112,114,101,97,100,0);
          let animations7 = String.fromCharCode(112,114,101,118,101,110,116,101,100,95,53,95,49,56,0);
          let robotob = String.fromCharCode(97,100,105,100,95,104,95,52,52,0);
          let textlayoutmanagerf = true;
         leaguev >>= Math.min(4, Math.abs((robotob == String.fromCharCode(57,0) ? robotob.length : animations7.length)));
         sportx = promotionS.length <= 47;
         promotionS = `${((sportx ? 3 : 1))}`;
         animations7 += `${((textlayoutmanagerf ? 2 : 5))}`;
         textlayoutmanagerf = (53 > ((!textlayoutmanagerf ? promotionS.length : 53) - promotionS.length));
      }
       let viewerp = false;
      while (5.53 >= (stard - 1.87) && (stard - 1.87) >= 5.26) {
         areas /= Math.max(4, parseFloat(`${3}`));
         break;
      }
      switch_fJ = `${refreshS.length + parseInt(`${libsgcoreu}`)}`;
   for (let v = 0; v < 2; v++) {
      save4 = `${feedbackC % (Math.max(parseInt(`${thailand4}`), 3))}`;
   }
   let backn = l_imageg >= 5179268;
   do {
      l_imageg <<= Math.min(Math.abs(1), 2);
      if (backn) {
         break;
      }
   } while ((2 == (4 & l_imageg) || (refreshS.length & 4) == 5) && backn);
      l_imageg &= (String.fromCharCode(102,0) == roundf ? roundf.length : l_imageg);
       let libjsinspectorT = false;
       let watchs: Array<any> = [533, 660];
      for (let y = 0; y < 1; y++) {
         watchs = [watchs.length * 3];
      }
          let referrerP = String.fromCharCode(103,101,116,97,117,120,118,97,108,95,109,95,56,52,0);
         libjsinspectorT = referrerP.length == 20;
      for (let v = 0; v < 3; v++) {
         libjsinspectorT = watchs.length == 28;
      }
         watchs = [(watchs.length << (Math.min(2, Math.abs((libjsinspectorT ? 4 : 2)))))];
      while (5 < (watchs.length + 2)) {
         watchs = [2];
         break;
      }
      for (let w = 0; w < 1; w++) {
         libjsinspectorT = (57 >= ((!libjsinspectorT ? 57 : watchs.length) >> (Math.min(watchs.length, 5))));
      }
      thailand4 -= (String.fromCharCode(74,0) == save4 ? watchs.length : save4.length);
   if (!refreshS.includes(feedbackC)) {
      refreshS = [parseInt(`${thailand4}`) ^ feedbackC];
   }
   for (let t = 0; t < 3; t++) {
       let tramini0 = String.fromCharCode(118,100,115,111,95,100,95,53,49,0);
       let neono: Array<any> = [659, 574];
       let libjsiW = 1.0;
      let humidityR = libjsiW <= 8191354.0;
      do {
          let overL = String.fromCharCode(104,115,118,97,95,98,95,49,56,0);
         libjsiW -= (String.fromCharCode(89,0) == tramini0 ? overL.length : tramini0.length);
         if (humidityR) {
            break;
         }
      } while ((neono.includes(libjsiW)) && humidityR);
          let eventH = true;
          let otherT = String.fromCharCode(110,95,55,51,95,118,114,101,103,105,111,110,0);
          let cancelr = String.fromCharCode(105,95,50,52,95,106,99,109,97,115,116,101,114,0);
         neono.push(2 & parseInt(`${libjsiW}`));
         eventH = (69 <= (cancelr.length >> (Math.min(5, Math.abs((eventH ? cancelr.length : 69))))));
         otherT += `${(String.fromCharCode(81,0) == cancelr ? otherT.length : cancelr.length)}`;
       let transferm = String.fromCharCode(118,95,53,51,95,102,111,114,98,105,100,100,101,110,0);
       let libavutilO = String.fromCharCode(107,95,53,52,95,105,110,118,105,116,101,115,0);
      while ((libavutilO.length << (Math.min(2, neono.length))) <= 5) {
         libavutilO += `${libavutilO.length}`;
         break;
      }
         neono = [neono.length];
      let gestureq = libjsiW <= 8064376.0;
      do {
         libjsiW -= libavutilO.length;
         if (gestureq) {
            break;
         }
      } while (((5.28 / (Math.max(7, libjsiW))) > 1.72) && gestureq);
      if (tramini0.length >= libavutilO.length) {
         libavutilO = "1";
      }
      if (5 == (4 << (Math.min(5, transferm.length))) && (transferm.length << (Math.min(Math.abs(4), 2))) == 4) {
         neono = [parseInt(`${libjsiW}`) - 3];
      }
      for (let b = 0; b < 1; b++) {
         tramini0 += `${neono.length}`;
      }
      componentK *= parseFloat(`${3}`);
   }

    setIsDialogOpen(!isDialogOpen);
  };

  const toggleHistory = (vod: yys_Bing) => {
    const filtered = removeHistory.filter((x) => x.vod_id !== vod.vod_id);
    if (filtered.length === removeHistory.length) {
      setRemoveHistory([vod, ...removeHistory]);
    } else {
      setRemoveHistory(filtered);
    }
  };
  let data = history;

  const today = new Date(); 

  let customHistoryToday: any = [];
  let customHistoryEarly: any = [];

  data.forEach((item) => {
    const recordedAt = new Date(item.recordedAt);
    if (
      recordedAt.toISOString().split("T")[0] ===
      today.toISOString().split("T")[0]
    ) {
      customHistoryToday.push(item);
    } else {
      customHistoryEarly.push(item);
    }
  });

  
  

  
  
  return (
    <ScreenContainer>
      <TitleWithBackButtonHeader
        title="播放历史"
        right={
          <TouchableOpacity
            onPress={() => {
              setIsEditing(!isEditing);
              setRemoveHistory([]);
            }}
          >
            <Text
              style={{
                ...textVariants.body,
                
                opacity: history && history.length > 0 ? 100 : 0,
              }}
            >
              {isEditing ? "取消" : "编辑"}
            </Text>
          </TouchableOpacity>
        }
        
      />
      {history && history.length > 0 ? (
        <ScrollView
          contentContainerStyle={styles.scrollContainer}
          showsVerticalScrollIndicator={false}
          showsHorizontalScrollIndicator={false}
        >
          {customHistoryToday.length > 0 && (
            <>
              <View style={{ marginBottom: 10 }}>
                <Text style={textStyles}>今日</Text>
                {customHistoryToday.map(
                  (item: yys_CountdownSubmit, index: number) => (
                    <View style={styles.card} key={index}>
                      {isEditing && (
                        <TouchableOpacity
                          style={styles.checkbox}
                          onPress={() => toggleHistory(item)}
                        >
                          {removeHistory.some(
                            (x) => x.vod_id === item.vod_id
                          ) ? (
                            <CheckBoxSelected
                              height={icons.sizes.m}
                              width={icons.sizes.m}
                            />
                          ) : (
                            <CheckBoxUnselected
                              height={icons.sizes.m}
                              width={icons.sizes.m}
                            />
                          )}
                        </TouchableOpacity>
                      )}
                      <VodHistoryCard
                        activeOpacity={isEditing ? 1 : 0.2}
                        vod={item}
                        onPress={() => {
                          if (isEditing) {
                            toggleHistory(item);
                          } else {
                            if (item.isAdultVideo){
                              dispatch(playVod(item));
                              navigation.navigate("播放", {
                                vod_id: item.vod_id,
                                player_mode: 'adult'
                              });
                              dispatch(enableAdultMode())
                            }
                            else {
                              dispatch(playVod(item));
                              navigation.navigate("播放", {
                                vod_id: item.vod_id,
                              });
                              dispatch(disableAdultMode())
                            }
                          }
                        }}
                      />
                    </View>
                  )
                )}
              </View>
            </>
          )}

          {customHistoryEarly.length > 0 && (
            <>
              <Text style={textStyles}>更早</Text>
              {customHistoryEarly.map((item: yys_CountdownSubmit, index: number) => (
                <View style={styles.card} key={index}>
                  {isEditing && (
                    <TouchableOpacity
                      style={styles.checkbox}
                      onPress={() => toggleHistory(item)}
                    >
                      {removeHistory.some((x) => x.vod_id === item.vod_id) ? (
                        <CheckBoxSelected
                          height={icons.sizes.m}
                          width={icons.sizes.m}
                        />
                      ) : (
                        <CheckBoxUnselected
                          height={icons.sizes.m}
                          width={icons.sizes.m}
                        />
                      )}
                    </TouchableOpacity>
                  )}
                  <VodHistoryCard
                    activeOpacity={isEditing ? 1 : 0.2}
                    vod={item}
                    onPress={() => {
                      if (isEditing) {
                        toggleHistory(item);
                      } else {
                        if (item.isAdultVideo){
                          dispatch(playVod(item));
                          navigation.navigate("播放", {
                            vod_id: item.vod_id,
                            player_mode: 'adult'
                          });
                          dispatch(enableAdultMode())
                        }
                        else {
                          dispatch(playVod(item));
                          navigation.navigate("播放", {
                            vod_id: item.vod_id,
                          });
                          dispatch(disableAdultMode())
                        }
                      }
                    }}
                  />
                </View>
              ))}
            </>
          )}
        </ScrollView>
      ) : (
        <EmptyList description="暂无播放历史" />
      )}
      <ConfirmationModal
        onConfirm={() => {
          dispatch(removeVodsFromHistory(removeHistory));
          setIsEditing(false);
          setRemoveHistory([]);
          toggleOverlay();
        }}
        onCancel={toggleOverlay}
        isVisible={isDialogOpen}
        title="清除提示"
        subtitle="您是否确定清除播放历史吗？"
      />
      {isEditing && (
        <View style={styles.deleteConfirmationModal}>
          <Button
            onPress={() => {
              if (
                removeHistory.length === 0 ||
                removeHistory.length !== history.length
              ) {
                setRemoveHistory(vodReducer.history);
              } else {
                setRemoveHistory([]);
              }
            }}
            containerStyle={styles.confirmationBtn}
            color={colors.card2}
            titleStyle={{ ...textVariants.body, color: colors.muted }}
          >
            {removeHistory.length === 0 ||
            removeHistory.length !== history.length
              ? "全选"
              : "取消全选"}
          </Button>
          <Button
            onPress={() => {
              if (removeHistory.length > 0) {
                toggleOverlay();
              }
            }}
            containerStyle={styles.confirmationBtn}
            color={removeHistory.length === 0 ? colors.card2 : colors.primary}
            titleStyle={{
              ...textVariants.body,
              color:
                removeHistory.length === 0 ? colors.muted : colors.background,
            }}
          >
            删除
          </Button>
        </View>
      )}
    </ScreenContainer>
  );
};

const styles = StyleSheet.create({
  scrollContainer: {
    paddingBottom: 30,
  },
  card: {
    display: "flex",
    flexDirection: "row",
    alignItems: "center",
  },
  checkbox: {
    padding: 5,
  },
  deleteConfirmationModal: {
    display: "flex",
    flexDirection: "row",
    alignItems: "center",
    justifyContent: "space-between",
    padding: 8,
  },
  confirmationBtn: {
    flex: 1,
    margin: 10,
    borderRadius: 10,
    marginTop: 8,
  },
  text: {
    flexShrink: 1,
    paddingLeft: 10,
    paddingRight: 10,
    paddingTop: 3,
    paddingBottom: 10,
  },
});
